<!doctype html>
<html lang="zh" data-hairline="true" data-reactroot="" data-reactid="1" data-react-checksum="862792232"><head data-reactid="2"><meta charset="utf-8" data-reactid="3"/><title data-react-helmet="true" data-reactid="4">可以用 Python 编程语言做哪些神奇好玩的事情？ - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" data-reactid="5"/><meta name="renderer" content="webkit" data-reactid="6"/><meta name="force-rendering" content="webkit" data-reactid="7"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" data-reactid="8"/><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg" data-reactid="9"/><meta data-react-helmet="true" name="apple-itunes-app" content="app-id=432274380, app-argument=zhihu://questions/21395276" data-reactid="10"/><link rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/static/favicon.ico" data-reactid="11"/><link rel="dns-prefetch" href="//static.zhimg.com" data-reactid="12"/><link rel="dns-prefetch" href="//pic1.zhimg.com" data-reactid="13"/><link rel="dns-prefetch" href="//pic2.zhimg.com" data-reactid="14"/><link rel="dns-prefetch" href="//pic3.zhimg.com" data-reactid="15"/><link rel="dns-prefetch" href="//pic4.zhimg.com" data-reactid="16"/><link href="https://static.zhihu.com/heifetz/main.app.4da95bc6e856c5d9b65d.css" rel="stylesheet" data-reactid="17"/></head><body class="Entry-body" data-reactid="18"><div id="root" data-reactid="19"><div data-zop-userToken="{}"><div class="LoadingBar"></div><div><header role="banner" class="Sticky AppHeader" data-za-module="TopNavBar"><div class="AppHeader-inner"><a href="/" aria-label="知乎"><svg viewBox="0 0 200 91" class="Icon Icon--logo" style="fill:#0f88eb;height:30px;width:64px;" width="64" height="30" aria-hidden="true"><title></title><g><path d="M53.29 80.035l7.32.002 2.41 8.24 13.128-8.24h15.477v-67.98H53.29v67.978zm7.79-60.598h22.756v53.22h-8.73l-8.718 5.473-1.587-5.46-3.72-.012v-53.22zM46.818 43.162h-16.35c.545-8.467.687-16.12.687-22.955h15.987s.615-7.05-2.68-6.97H16.807c1.09-4.1 2.46-8.332 4.1-12.708 0 0-7.523 0-10.085 6.74-1.06 2.78-4.128 13.48-9.592 24.41 1.84-.2 7.927-.37 11.512-6.94.66-1.84.785-2.08 1.605-4.54h9.02c0 3.28-.374 20.9-.526 22.95H6.51c-3.67 0-4.863 7.38-4.863 7.38H22.14C20.765 66.11 13.385 79.24 0 89.62c6.403 1.828 12.784-.29 15.937-3.094 0 0 7.182-6.53 11.12-21.64L43.92 85.18s2.473-8.402-.388-12.496c-2.37-2.788-8.768-10.33-11.496-13.064l-4.57 3.627c1.363-4.368 2.183-8.61 2.46-12.71H49.19s-.027-7.38-2.372-7.38zm128.752-.502c6.51-8.013 14.054-18.302 14.054-18.302s-5.827-4.625-8.556-1.27c-1.874 2.548-11.51 15.063-11.51 15.063l6.012 4.51zm-46.903-18.462c-2.814-2.577-8.096.667-8.096.667s12.35 17.2 12.85 17.953l6.08-4.29s-8.02-11.752-10.83-14.33zM199.99 46.5c-6.18 0-40.908.292-40.953.292v-31.56c1.503 0 3.882-.124 7.14-.376 12.773-.753 21.914-1.25 27.427-1.504 0 0 3.817-8.496-.185-10.45-.96-.37-7.24 1.43-7.24 1.43s-51.63 5.153-72.61 5.64c.5 2.756 2.38 5.336 4.93 6.11 4.16 1.087 7.09.53 15.36.277 7.76-.5 13.65-.76 17.66-.76v31.19h-41.71s.88 6.97 7.97 7.14h33.73v22.16c0 4.364-3.498 6.87-7.65 6.6-4.4.034-8.15-.36-13.027-.566.623 1.24 1.977 4.496 6.035 6.824 3.087 1.502 5.054 2.053 8.13 2.053 9.237 0 14.27-5.4 14.027-14.16V53.93h38.235c3.026 0 2.72-7.432 2.72-7.432z" fill-rule="evenodd"/></g></svg></a><nav role="navigation" class="AppHeader-nav"><a class="AppHeader-navItem" href="/">首页</a><a class="AppHeader-navItem" href="/explore">发现</a><a class="AppHeader-navItem" href="/topic">话题</a></nav><div class="SearchBar" role="search"><div class="SearchBar-toolWrapper"><form class="SearchBar-tool"><div><div class="Popover"><div class="SearchBar-input Input-wrapper Input-wrapper--grey"><input type="text" maxlength="100" value="" autocomplete="off" role="combobox" aria-expanded="false" aria-autocomplete="list" aria-activedescendant="null--1" id="null-toggle" aria-haspopup="true" aria-owns="null-content" class="Input" placeholder="搜索你感兴趣的内容…"/><div class="Input-after"><button class="Button SearchBar-searchIcon Button--primary" aria-label="搜索" type="button"><svg viewBox="0 0 16 16" class="Icon Icon--search" style="height:16px;width:16px;" width="16" height="16" aria-hidden="true"><title></title><g><path d="M12.054 10.864c.887-1.14 1.42-2.57 1.42-4.127C13.474 3.017 10.457 0 6.737 0S0 3.016 0 6.737c0 3.72 3.016 6.737 6.737 6.737 1.556 0 2.985-.533 4.127-1.42l3.103 3.104c.765.46 1.705-.37 1.19-1.19l-3.103-3.104zm-5.317.925c-2.786 0-5.053-2.267-5.053-5.053S3.95 1.684 6.737 1.684 11.79 3.95 11.79 6.737 9.522 11.79 6.736 11.79z"/></g></svg></button></div></div></div></div></form></div></div><div class="AppHeader-userInfo"><div class="AppHeader-profile"><div><button class="Button AppHeader-login Button--blue" type="button">登录</button><button class="Button Button--primary Button--blue" type="button">加入知乎</button></div></div></div></div></header></div><main role="main" class="App-main"><div class="QuestionPage" itemscope="" itemtype="http://schema.org/Question"><meta itemprop="name" content="可以用 Python 编程语言做哪些神奇好玩的事情？"/><meta itemprop="url" content="https://www.zhihu.com/question/21395276"/><meta itemprop="keywords" content="软件开发,编程语言,Python,程序"/><meta itemprop="answerCount" content="170"/><meta itemprop="commentCount" content="7"/><meta itemprop="dateCreated" content="2013-07-28T05:41:15.000Z"/><meta itemprop="dateModified" content="2014-08-17T06:18:58.000Z"/><meta itemprop="zhihu:visitsCount"/><meta itemprop="zhihu:followerCount" content="25918"/><div data-zop-question="{&quot;title&quot;:&quot;可以用 Python 编程语言做哪些神奇好玩的事情？&quot;,&quot;topics&quot;:[{&quot;name&quot;:&quot;软件开发&quot;,&quot;id&quot;:&quot;19552332&quot;},{&quot;name&quot;:&quot;编程语言&quot;,&quot;id&quot;:&quot;19552826&quot;},{&quot;name&quot;:&quot;Python&quot;,&quot;id&quot;:&quot;19552832&quot;},{&quot;name&quot;:&quot;程序&quot;,&quot;id&quot;:&quot;19565652&quot;}],&quot;id&quot;:21395276,&quot;isEditable&quot;:false}"><div class="QuestionHeader"><div class="QuestionHeader-content"><div class="QuestionHeader-main"><div class="QuestionHeader-tags"><div class="QuestionHeader-topics"><div class="Tag QuestionTopic"><span class="Tag-content"><a class="TopicLink" href="/topic/19552332"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">软件开发</div></div></a></span></div><div class="Tag QuestionTopic"><span class="Tag-content"><a class="TopicLink" href="/topic/19552826"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">编程语言</div></div></a></span></div><div class="Tag QuestionTopic"><span class="Tag-content"><a class="TopicLink" href="/topic/19552832"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">Python</div></div></a></span></div><div class="Tag QuestionTopic"><span class="Tag-content"><a class="TopicLink" href="/topic/19565652"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content">程序</div></div></a></span></div></div></div><h1 class="QuestionHeader-title">可以用 Python 编程语言做哪些神奇好玩的事情？</h1><div class="QuestionHeader-detail"><div class="QuestionRichText QuestionRichText--expandable QuestionRichText--collapsed"><div><span class="RichText" itemprop="text">请说明为什么这些事情适合用 Python 做。</span><button class="Button QuestionRichText-more Button--plain" type="button">显示全部<svg viewBox="0 0 10 6" class="Icon QuestionRichText-more-icon Icon--arrow" style="height:16px;width:10px;" width="10" height="16" aria-hidden="true"><title></title><g><path d="M8.716.217L5.002 4 1.285.218C.99-.072.514-.072.22.218c-.294.29-.294.76 0 1.052l4.25 4.512c.292.29.77.29 1.063 0L9.78 1.27c.293-.29.293-.76 0-1.052-.295-.29-.77-.29-1.063 0z"/></g></svg></button></div></div></div></div><div class="QuestionHeader-side"><div class="QuestionHeader-follow-status"><div class="QuestionFollowStatus"><div class="NumberBoard QuestionFollowStatus-counts"><div class="NumberBoard-item"><div class="NumberBoard-name">关注者</div><div class="NumberBoard-value">25918</div></div><div class="NumberBoard-divider"></div><div class="NumberBoard-item"><div class="NumberBoard-name">被浏览</div><div class="NumberBoard-value">2008525</div></div></div></div></div></div></div><div class="QuestionHeader-footer"><div class="QuestionHeader-footer-inner"><div class="QuestionHeader-main QuestionHeader-footer-main"><div class="QuestionHeaderActions"><div class="QuestionHeader-Comment"><button class="Button Button--plain" type="button"><svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--comment Icon--left" style="height:15px;width:20px;" width="20" height="15" aria-hidden="true"><title></title><g><path d="M7.24 16.313c-.272-.047-.553.026-.77.2-1.106.813-2.406 1.324-3.77 1.482-.16.017-.313-.06-.394-.197-.082-.136-.077-.308.012-.44.528-.656.906-1.42 1.11-2.237.04-.222-.046-.45-.226-.588C1.212 13.052.027 10.73 0 8.25 0 3.7 4.03 0 9 0s9 3.7 9 8.25-4.373 9.108-10.76 8.063z"/></g></svg>7 条评论</button></div><div class="Popover ShareMenu"><div class="" id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button class="Button Button--plain" type="button"><svg viewBox="0 0 20 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--share Icon--left" style="height:16px;width:13px;" width="13" height="16" aria-hidden="true"><title></title><g><path d="M.93 3.89C-.135 4.13-.343 5.56.614 6.098L5.89 9.005l8.168-4.776c.25-.128.477.197.273.388L7.05 10.66l.926 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.243c.584-.892-.212-2.03-1.234-1.796L.93 3.89z"/></g></svg>分享</button></div></div><button class="Button Button--plain" type="button"><svg viewBox="0 0 20 20" class="Icon Icon--star Icon--left" style="height:16px;width:13px;" width="13" height="16" aria-hidden="true"><title></title><g><path d="M3.515 17.64l.918-5.355-3.89-3.792c-.926-.902-.64-1.784.64-1.97L6.56 5.74 8.964.87c.572-1.16 1.5-1.16 2.072 0l2.404 4.87 5.377.783c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.22 1.274-.532 1.82-1.676 1.218L10 16.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z"/></g></svg>邀请回答</button><div class="Popover"><button class="Button Button--plain" type="button" id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><svg viewBox="0 0 18 4" class="Icon Icon--dots" style="height:16px;width:14px;" width="14" height="16" aria-hidden="true"><title></title><g><g><circle cx="2" cy="2" r="2"/><circle cx="9" cy="2" r="2"/><circle cx="16" cy="2" r="2"/></g></g></svg></button></div></div><div class="QuestionHeader-actions"></div></div><div class="QuestionHeader-side"><div class="QuestionButtonGroup"><button class="Button Button--primary Button--blue" type="button">关注问题</button><button class="Button Button--blue" type="button"><svg viewBox="0 0 12 12" class="Icon Button-icon Icon--modify" style="height:16px;width:14px;" width="14" height="16" aria-hidden="true"><title></title><g><path d="M.423 10.32L0 12l1.667-.474 1.55-.44-2.4-2.33-.394 1.564zM10.153.233c-.327-.318-.85-.31-1.17.018l-.793.817 2.49 2.414.792-.814c.318-.328.312-.852-.017-1.17l-1.3-1.263zM3.84 10.536L1.35 8.122l6.265-6.46 2.49 2.414-6.265 6.46z" fill-rule="evenodd"/></g></svg>写回答</button></div></div></div></div></div><div><div><div class="Sticky"></div></div></div></div><div class="Question-main"><div class="Question-mainColumn"><div><div id="QuestionAnswers-answers" class="QuestionAnswers-answers"><div class="Card"><div class="List"><div class="List-header"><h4 class="List-headerText"><span>170 个回答</span></h4><div class="List-headerOptions"><div class="Popover"><button class="Button Select-button Select-plainButton Button--plain" role="combobox" aria-expanded="false" type="button" id="null-toggle" aria-haspopup="true" aria-owns="null-content">默认排序<svg viewBox="0 0 8 13" class="Icon Select-arrow Icon--select" style="height:16px;width:8px;" width="8" height="16" aria-hidden="true"><title></title><g><path d="M4 11.183L1.284 8.218c-.293-.29-.77-.29-1.064 0-.293.29-.293.76 0 1.052l3.25 3.512c.292.29.768.29 1.062 0L7.78 9.27c.293-.29.293-.76 0-1.052-.295-.29-.77-.29-1.064 0L4 11.182zM4 1.818L1.284 4.782c-.293.29-.77.29-1.064 0-.293-.29-.293-.76 0-1.052L3.47.218c.292-.29.768-.29 1.062 0L7.78 3.73c.293.29.293.76 0 1.052-.295.29-.77.29-1.064 0L4 1.82z"/></g></svg></button></div></div></div><div data-zop-feedlist="true"><div class="List-item"><div class="ContentItem AnswerItem" data-za-index="0" data-zop="{&quot;authorName&quot;:&quot;杨航锋&quot;,&quot;itemId&quot;:115805610,&quot;title&quot;:&quot;可以用 Python 编程语言做哪些神奇好玩的事情？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="115805610" itemprop="acceptedAnswer" itemtype="http://schema.org/Answer" itemscope=""><div class="ContentItem-meta"><div class="AnswerItem-meta AnswerItem-meta--related"><div class="AuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="杨航锋"/><meta itemprop="image" content="https://pic3.zhimg.com/50/910388ae59c4403bbc9fc847fd629e76_hd.jpg"/><meta itemprop="url" content="https://www.zhihu.com/people/zhi-mu-qing-yang"/><meta itemprop="zhihu:followerCount" content="2890"/><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><a class="UserLink-link" data-za-detail-view-element_name="User" href="/people/zhi-mu-qing-yang"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="https://pic3.zhimg.com/50/910388ae59c4403bbc9fc847fd629e76_xs.jpg" srcset="https://pic3.zhimg.com/50/910388ae59c4403bbc9fc847fd629e76_l.jpg 2x" alt="杨航锋"/></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><a class="UserLink-link" data-za-detail-view-element_name="User" href="/people/zhi-mu-qing-yang">杨航锋</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="RichText AuthorInfo-badgeText">机器学习/数据爱好者/Pythoner</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button class="Button Button--plain" type="button">2651 人赞同了该回答</button></span></div></div></div><meta itemprop="image" content="https://pic3.zhimg.com/98cab4f35d2084f969a8189e90b47dee_200x112.jpg"/><meta itemprop="upvoteCount" content="2651"/><meta itemprop="url" content="https://www.zhihu.com/question/21395276/answer/115805610"/><meta itemprop="dateCreated" content="2016-08-09T01:59:11.000Z"/><meta itemprop="dateModified" content="2017-05-01T08:56:40.000Z"/><meta itemprop="commentCount" content="418"/><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText CopyrightRichText-richText" itemprop="text"><p><u><b>可以画画啊！可以画画啊！可以画画啊！</b></u> 对，有趣的事情需要讲三遍。
事情是这样的，通过python的深度学习算法包去训练计算机模仿世界名画的风格，然后应用到另一幅画中，不多说直接上图！</p><noscript><img src="https://pic3.zhimg.com/50/98cab4f35d2084f969a8189e90b47dee_hd.jpg" data-rawwidth="468" data-rawheight="600" class="origin_image zh-lightbox-thumb" width="468" data-original="https://pic3.zhimg.com/98cab4f35d2084f969a8189e90b47dee_r.jpg"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='468'%20height='600'&gt;&lt;/svg&gt;" data-rawwidth="468" data-rawheight="600" class="origin_image zh-lightbox-thumb lazy" width="468" data-original="https://pic3.zhimg.com/98cab4f35d2084f969a8189e90b47dee_r.jpg" data-actualsrc="https://pic3.zhimg.com/50/98cab4f35d2084f969a8189e90b47dee_hd.jpg"><br><p>这个是世界名画”<i>毕加索的自画像</i>“（我也不懂什么是世界名画，但是我会google呀哈哈），以这张图片为模板，让计算机去学习这张图片的风格（至于怎么学习请参照这篇国外大牛的论文<a href="https://link.zhihu.com/?target=http%3A//arxiv.org/abs/1508.06576" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">arxiv.org/abs/1508.0657</span><span class="invisible">6</span><span class="ellipsis"></span><i class="icon-external"></i></a>）应用到自己的这张图片上。</p><noscript><img src="https://pic2.zhimg.com/50/7ca4eb6c6088ad9880a4bc1a9993ed35_hd.jpg" data-rawwidth="249" data-rawheight="365" class="content_image" width="249"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='249'%20height='365'&gt;&lt;/svg&gt;" data-rawwidth="249" data-rawheight="365" class="content_image lazy" width="249" data-actualsrc="https://pic2.zhimg.com/50/7ca4eb6c6088ad9880a4bc1a9993ed35_hd.jpg"><p>结果就变成下面这个样子了</p><noscript><img src="https://pic1.zhimg.com/50/b869feb93320634a2c05752efd02bc74_hd.png" data-rawwidth="472" data-rawheight="660" class="origin_image zh-lightbox-thumb" width="472" data-original="https://pic1.zhimg.com/b869feb93320634a2c05752efd02bc74_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='472'%20height='660'&gt;&lt;/svg&gt;" data-rawwidth="472" data-rawheight="660" class="origin_image zh-lightbox-thumb lazy" width="472" data-original="https://pic1.zhimg.com/b869feb93320634a2c05752efd02bc74_r.png" data-actualsrc="https://pic1.zhimg.com/50/b869feb93320634a2c05752efd02bc74_hd.png"><br><p>咦，吓死宝宝了，不过好玩的东西当然要身先士卒啦！
接着由于距离开学也越来越近了，为了给广大新生营造一个良好的校园，噗！为了美化校园在新生心目中的形象学长真的不是有意要欺骗你们的。特意制作了下面的《梵高笔下的东华理工大学》，是不是没有听说过这个大学，的确她就是一个普通的二本学校不过这都不是重点。
左边的图片是梵高的《星空》作为模板，中间的图片是待转化的图片，右边的图片是结果</p><noscript><img src="https://pic2.zhimg.com/50/16b2c1522cea0ae43c4d2c1cc6871b29_hd.png" data-rawwidth="852" data-rawheight="172" class="origin_image zh-lightbox-thumb" width="852" data-original="https://pic2.zhimg.com/16b2c1522cea0ae43c4d2c1cc6871b29_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='852'%20height='172'&gt;&lt;/svg&gt;" data-rawwidth="852" data-rawheight="172" class="origin_image zh-lightbox-thumb lazy" width="852" data-original="https://pic2.zhimg.com/16b2c1522cea0ae43c4d2c1cc6871b29_r.png" data-actualsrc="https://pic2.zhimg.com/50/16b2c1522cea0ae43c4d2c1cc6871b29_hd.png"><p>这是我们学校的内“湖”（池塘）</p><noscript><img src="https://pic1.zhimg.com/50/193695070e8614fb75b4735ad2d68734_hd.png" data-rawwidth="856" data-rawheight="173" class="origin_image zh-lightbox-thumb" width="856" data-original="https://pic1.zhimg.com/193695070e8614fb75b4735ad2d68734_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='856'%20height='173'&gt;&lt;/svg&gt;" data-rawwidth="856" data-rawheight="173" class="origin_image zh-lightbox-thumb lazy" width="856" data-original="https://pic1.zhimg.com/193695070e8614fb75b4735ad2d68734_r.png" data-actualsrc="https://pic1.zhimg.com/50/193695070e8614fb75b4735ad2d68734_hd.png"><p>校园里的樱花广场（个人觉得这是我校最浪漫的地方了）</p><noscript><img src="https://pic3.zhimg.com/50/dd333413cb332f5d0681ba479249f802_hd.png" data-rawwidth="848" data-rawheight="206" class="origin_image zh-lightbox-thumb" width="848" data-original="https://pic3.zhimg.com/dd333413cb332f5d0681ba479249f802_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='848'%20height='206'&gt;&lt;/svg&gt;" data-rawwidth="848" data-rawheight="206" class="origin_image zh-lightbox-thumb lazy" width="848" data-original="https://pic3.zhimg.com/dd333413cb332f5d0681ba479249f802_r.png" data-actualsrc="https://pic3.zhimg.com/50/dd333413cb332f5d0681ba479249f802_hd.png"><p>不多说，学校图书馆</p><noscript><img src="https://pic4.zhimg.com/50/9029082a8fdb697873f7250d0137a617_hd.png" data-rawwidth="851" data-rawheight="194" class="origin_image zh-lightbox-thumb" width="851" data-original="https://pic4.zhimg.com/9029082a8fdb697873f7250d0137a617_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='851'%20height='194'&gt;&lt;/svg&gt;" data-rawwidth="851" data-rawheight="194" class="origin_image zh-lightbox-thumb lazy" width="851" data-original="https://pic4.zhimg.com/9029082a8fdb697873f7250d0137a617_r.png" data-actualsrc="https://pic4.zhimg.com/50/9029082a8fdb697873f7250d0137a617_hd.png"><p>“池塘”边的柳树</p><noscript><img src="https://pic1.zhimg.com/50/8d8dcbca85b62f276129d6d237d4d6fc_hd.png" data-rawwidth="852" data-rawheight="204" class="origin_image zh-lightbox-thumb" width="852" data-original="https://pic1.zhimg.com/8d8dcbca85b62f276129d6d237d4d6fc_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='852'%20height='204'&gt;&lt;/svg&gt;" data-rawwidth="852" data-rawheight="204" class="origin_image zh-lightbox-thumb lazy" width="852" data-original="https://pic1.zhimg.com/8d8dcbca85b62f276129d6d237d4d6fc_r.png" data-actualsrc="https://pic1.zhimg.com/50/8d8dcbca85b62f276129d6d237d4d6fc_hd.png"><p>学校东大门</p><noscript><img src="https://pic1.zhimg.com/50/ad22383f37f56d92517b18bb830ee7c8_hd.png" data-rawwidth="862" data-rawheight="164" class="origin_image zh-lightbox-thumb" width="862" data-original="https://pic1.zhimg.com/ad22383f37f56d92517b18bb830ee7c8_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='862'%20height='164'&gt;&lt;/svg&gt;" data-rawwidth="862" data-rawheight="164" class="origin_image zh-lightbox-thumb lazy" width="862" data-original="https://pic1.zhimg.com/ad22383f37f56d92517b18bb830ee7c8_r.png" data-actualsrc="https://pic1.zhimg.com/50/ad22383f37f56d92517b18bb830ee7c8_hd.png"><p>学校测绘楼</p><noscript><img src="https://pic3.zhimg.com/50/cb6d76286324c857528892014d04bb3e_hd.png" data-rawwidth="852" data-rawheight="211" class="origin_image zh-lightbox-thumb" width="852" data-original="https://pic3.zhimg.com/cb6d76286324c857528892014d04bb3e_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='852'%20height='211'&gt;&lt;/svg&gt;" data-rawwidth="852" data-rawheight="211" class="origin_image zh-lightbox-thumb lazy" width="852" data-original="https://pic3.zhimg.com/cb6d76286324c857528892014d04bb3e_r.png" data-actualsrc="https://pic3.zhimg.com/50/cb6d76286324c857528892014d04bb3e_hd.png"><p>学校地学楼</p><p>为了便于观看，附上生成后的大图：</p><noscript><img src="https://pic3.zhimg.com/50/d7ee30ae90b3d81049abee478e8e75b6_hd.png" data-rawwidth="699" data-rawheight="408" class="origin_image zh-lightbox-thumb" width="699" data-original="https://pic3.zhimg.com/d7ee30ae90b3d81049abee478e8e75b6_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='699'%20height='408'&gt;&lt;/svg&gt;" data-rawwidth="699" data-rawheight="408" class="origin_image zh-lightbox-thumb lazy" width="699" data-original="https://pic3.zhimg.com/d7ee30ae90b3d81049abee478e8e75b6_r.png" data-actualsrc="https://pic3.zhimg.com/50/d7ee30ae90b3d81049abee478e8e75b6_hd.png"><br><noscript><img src="https://pic3.zhimg.com/50/c04d56309b493bd2a0d3db26d0916206_hd.png" data-rawwidth="700" data-rawheight="465" class="origin_image zh-lightbox-thumb" width="700" data-original="https://pic3.zhimg.com/c04d56309b493bd2a0d3db26d0916206_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='700'%20height='465'&gt;&lt;/svg&gt;" data-rawwidth="700" data-rawheight="465" class="origin_image zh-lightbox-thumb lazy" width="700" data-original="https://pic3.zhimg.com/c04d56309b493bd2a0d3db26d0916206_r.png" data-actualsrc="https://pic3.zhimg.com/50/c04d56309b493bd2a0d3db26d0916206_hd.png"><br><noscript><img src="https://pic1.zhimg.com/50/f41d8d145b8a8fe30abba37ede85c778_hd.png" data-rawwidth="695" data-rawheight="370" class="origin_image zh-lightbox-thumb" width="695" data-original="https://pic1.zhimg.com/f41d8d145b8a8fe30abba37ede85c778_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='695'%20height='370'&gt;&lt;/svg&gt;" data-rawwidth="695" data-rawheight="370" class="origin_image zh-lightbox-thumb lazy" width="695" data-original="https://pic1.zhimg.com/f41d8d145b8a8fe30abba37ede85c778_r.png" data-actualsrc="https://pic1.zhimg.com/50/f41d8d145b8a8fe30abba37ede85c778_hd.png"><br><noscript><img src="https://pic1.zhimg.com/50/797a561056109585428a10c9a6278874_hd.png" data-rawwidth="700" data-rawheight="447" class="origin_image zh-lightbox-thumb" width="700" data-original="https://pic1.zhimg.com/797a561056109585428a10c9a6278874_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='700'%20height='447'&gt;&lt;/svg&gt;" data-rawwidth="700" data-rawheight="447" class="origin_image zh-lightbox-thumb lazy" width="700" data-original="https://pic1.zhimg.com/797a561056109585428a10c9a6278874_r.png" data-actualsrc="https://pic1.zhimg.com/50/797a561056109585428a10c9a6278874_hd.png"><br><noscript><img src="https://pic1.zhimg.com/50/d4e2ac5460d08d0cd9af15bc154574e4_hd.png" data-rawwidth="699" data-rawheight="469" class="origin_image zh-lightbox-thumb" width="699" data-original="https://pic1.zhimg.com/d4e2ac5460d08d0cd9af15bc154574e4_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='699'%20height='469'&gt;&lt;/svg&gt;" data-rawwidth="699" data-rawheight="469" class="origin_image zh-lightbox-thumb lazy" width="699" data-original="https://pic1.zhimg.com/d4e2ac5460d08d0cd9af15bc154574e4_r.png" data-actualsrc="https://pic1.zhimg.com/50/d4e2ac5460d08d0cd9af15bc154574e4_hd.png"><br><noscript><img src="https://pic4.zhimg.com/50/7ea97eab41a2c2eb32d356b1afd9ca2f_hd.png" data-rawwidth="698" data-rawheight="409" class="origin_image zh-lightbox-thumb" width="698" data-original="https://pic4.zhimg.com/7ea97eab41a2c2eb32d356b1afd9ca2f_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='698'%20height='409'&gt;&lt;/svg&gt;" data-rawwidth="698" data-rawheight="409" class="origin_image zh-lightbox-thumb lazy" width="698" data-original="https://pic4.zhimg.com/7ea97eab41a2c2eb32d356b1afd9ca2f_r.png" data-actualsrc="https://pic4.zhimg.com/50/7ea97eab41a2c2eb32d356b1afd9ca2f_hd.png"><br><noscript><img src="https://pic1.zhimg.com/50/5f1f741537b28b9ec9e0d6e66b76a2cc_hd.png" data-rawwidth="699" data-rawheight="469" class="origin_image zh-lightbox-thumb" width="699" data-original="https://pic1.zhimg.com/5f1f741537b28b9ec9e0d6e66b76a2cc_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='699'%20height='469'&gt;&lt;/svg&gt;" data-rawwidth="699" data-rawheight="469" class="origin_image zh-lightbox-thumb lazy" width="699" data-original="https://pic1.zhimg.com/5f1f741537b28b9ec9e0d6e66b76a2cc_r.png" data-actualsrc="https://pic1.zhimg.com/50/5f1f741537b28b9ec9e0d6e66b76a2cc_hd.png"><br><p>别看才区区七张图片，可是这让计算机运行了好长的时间，期间电脑死机两次！</p><p>好了广告打完了，下面是福利时间</p><h2><b>在本地用keras搭建风格转移平台</b></h2><h2><b>1.相关依赖库的安装</b></h2><div class="highlight"><pre><code class="language-text"><span></span># 命令行安装keras、h5py、tensorflow
pip3 install keras
pip3 install h5py
pip3 install tensorflow
</code></pre></div><p>如果tensorflowan命令行安装失败，可以在这里下载whl包<a href="https://link.zhihu.com/?target=http%3A//www.lfd.uci.edu/%7Egohlke/pythonlibs/" class=" wrap external" target="_blank" rel="nofollow noreferrer">Python Extension Packages for Windows<i class="icon-external"></i></a><a href="https://link.zhihu.com/?target=http%3A//www.lfd.uci.edu/%7Egohlke/pythonlibs/" class=" wrap external" target="_blank" rel="nofollow noreferrer">（进入网址后ctrl+F输入tensorflow可以快速搜索）<i class="icon-external"></i></a></p><h2><b>2.配置运行环境</b></h2><p><b>下载VGG16模型 </b><a href="https://link.zhihu.com/?target=https%3A//pan.baidu.com/s/1i5wYN1z" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">pan.baidu.com/s/1i5wYN1</span><span class="invisible">z</span><span class="ellipsis"></span><i class="icon-external"></i></a> 放入如下目录当中</p><noscript><img src="https://pic1.zhimg.com/50/v2-b06fa971e3b6ebc905097f89be3ce39c_hd.png" data-rawwidth="654" data-rawheight="129" class="origin_image zh-lightbox-thumb" width="654" data-original="https://pic1.zhimg.com/v2-b06fa971e3b6ebc905097f89be3ce39c_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='654'%20height='129'&gt;&lt;/svg&gt;" data-rawwidth="654" data-rawheight="129" class="origin_image zh-lightbox-thumb lazy" width="654" data-original="https://pic1.zhimg.com/v2-b06fa971e3b6ebc905097f89be3ce39c_r.png" data-actualsrc="https://pic1.zhimg.com/50/v2-b06fa971e3b6ebc905097f89be3ce39c_hd.png"><h2><b>3.代码编写</b></h2><div class="highlight"><pre><code class="language-python3"><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">keras.preprocessing.image</span> <span class="k">import</span> <span class="n">load_img</span><span class="p">,</span> <span class="n">img_to_array</span>
<span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="k">import</span> <span class="n">imsave</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="k">import</span> <span class="n">fmin_l_bfgs_b</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">argparse</span>

<span class="kn">from</span> <span class="nn">keras.applications</span> <span class="k">import</span> <span class="n">vgg16</span>
<span class="kn">from</span> <span class="nn">keras</span> <span class="k">import</span> <span class="n">backend</span> <span class="k">as</span> <span class="n">K</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">'Neural style transfer with Keras.'</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'base_image_path'</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">'base'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                    <span class="n">help</span><span class="o">=</span><span class="s1">'Path to the image to transform.'</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'style_reference_image_path'</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">'ref'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                    <span class="n">help</span><span class="o">=</span><span class="s1">'Path to the style reference image.'</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'result_prefix'</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">'res_prefix'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                    <span class="n">help</span><span class="o">=</span><span class="s1">'Prefix for the saved results.'</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'--iter'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">help</span><span class="o">=</span><span class="s1">'Number of iterations to run.'</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'--content_weight'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">help</span><span class="o">=</span><span class="s1">'Content weight.'</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'--style_weight'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">help</span><span class="o">=</span><span class="s1">'Style weight.'</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'--tv_weight'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">help</span><span class="o">=</span><span class="s1">'Total Variation weight.'</span><span class="p">)</span>

<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="n">base_image_path</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">base_image_path</span>
<span class="n">style_reference_image_path</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">style_reference_image_path</span>
<span class="n">result_prefix</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">result_prefix</span>
<span class="n">iterations</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">iter</span>

<span class="c1"># these are the weights of the different loss components</span>
<span class="n">total_variation_weight</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">tv_weight</span>
<span class="n">style_weight</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">style_weight</span>
<span class="n">content_weight</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">content_weight</span>

<span class="c1"># dimensions of the generated picture.</span>
<span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">load_img</span><span class="p">(</span><span class="n">base_image_path</span><span class="p">)</span><span class="o">.</span><span class="n">size</span>
<span class="n">img_nrows</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">img_ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="n">img_nrows</span> <span class="o">/</span> <span class="n">height</span><span class="p">)</span>

<span class="c1"># util function to open, resize and format pictures into appropriate tensors</span>


<span class="k">def</span> <span class="nf">preprocess_image</span><span class="p">(</span><span class="n">image_path</span><span class="p">):</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">load_img</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">target_size</span><span class="o">=</span><span class="p">(</span><span class="n">img_nrows</span><span class="p">,</span> <span class="n">img_ncols</span><span class="p">))</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">img_to_array</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">vgg16</span><span class="o">.</span><span class="n">preprocess_input</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">img</span>

<span class="c1"># util function to convert a tensor into a valid image</span>


<span class="k">def</span> <span class="nf">deprocess_image</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">K</span><span class="o">.</span><span class="n">image_data_format</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'channels_first'</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="n">img_nrows</span><span class="p">,</span> <span class="n">img_ncols</span><span class="p">))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">img_nrows</span><span class="p">,</span> <span class="n">img_ncols</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="c1"># Remove zero-center by mean pixel</span>
    <span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">103.939</span>
    <span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">116.779</span>
    <span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">123.68</span>
    <span class="c1"># 'BGR'-&gt;'RGB'</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'uint8'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="c1"># get tensor representations of our images</span>
<span class="n">base_image</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="n">preprocess_image</span><span class="p">(</span><span class="n">base_image_path</span><span class="p">))</span>
<span class="n">style_reference_image</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="n">preprocess_image</span><span class="p">(</span><span class="n">style_reference_image_path</span><span class="p">))</span>

<span class="c1"># this will contain our generated image</span>
<span class="k">if</span> <span class="n">K</span><span class="o">.</span><span class="n">image_data_format</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'channels_first'</span><span class="p">:</span>
    <span class="n">combination_image</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">placeholder</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">img_nrows</span><span class="p">,</span> <span class="n">img_ncols</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">combination_image</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">placeholder</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">img_nrows</span><span class="p">,</span> <span class="n">img_ncols</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># combine the 3 images into a single Keras tensor</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">base_image</span><span class="p">,</span>
                              <span class="n">style_reference_image</span><span class="p">,</span>
                              <span class="n">combination_image</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># build the VGG16 network with our 3 images as input</span>
<span class="c1"># the model will be loaded with pre-trained ImageNet weights</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">vgg16</span><span class="o">.</span><span class="n">VGG16</span><span class="p">(</span><span class="n">input_tensor</span><span class="o">=</span><span class="n">input_tensor</span><span class="p">,</span>
                    <span class="n">weights</span><span class="o">=</span><span class="s1">'imagenet'</span><span class="p">,</span> <span class="n">include_top</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Model loaded.'</span><span class="p">)</span>

<span class="c1"># get the symbolic outputs of each "key" layer (we gave them unique names).</span>
<span class="n">outputs_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">layer</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">layer</span><span class="o">.</span><span class="n">output</span><span class="p">)</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">])</span>

<span class="c1"># compute the neural style loss</span>
<span class="c1"># first we need to define 4 util functions</span>

<span class="c1"># the gram matrix of an image tensor (feature-wise outer product)</span>


<span class="k">def</span> <span class="nf">gram_matrix</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">K</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
    <span class="k">if</span> <span class="n">K</span><span class="o">.</span><span class="n">image_data_format</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'channels_first'</span><span class="p">:</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">batch_flatten</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">batch_flatten</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">permute_dimensions</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="n">gram</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">K</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">features</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">gram</span>

<span class="c1"># the "style loss" is designed to maintain</span>
<span class="c1"># the style of the reference image in the generated image.</span>
<span class="c1"># It is based on the gram matrices (which capture style) of</span>
<span class="c1"># feature maps from the style reference image</span>
<span class="c1"># and from the generated image</span>


<span class="k">def</span> <span class="nf">style_loss</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">K</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">style</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
    <span class="k">assert</span> <span class="n">K</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">combination</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">gram_matrix</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">gram_matrix</span><span class="p">(</span><span class="n">combination</span><span class="p">)</span>
    <span class="n">channels</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">img_nrows</span> <span class="o">*</span> <span class="n">img_ncols</span>
    <span class="k">return</span> <span class="n">K</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">S</span> <span class="o">-</span> <span class="n">C</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.</span> <span class="o">*</span> <span class="p">(</span><span class="n">channels</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">size</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>

<span class="c1"># an auxiliary loss function</span>
<span class="c1"># designed to maintain the "content" of the</span>
<span class="c1"># base image in the generated image</span>


<span class="k">def</span> <span class="nf">content_loss</span><span class="p">(</span><span class="n">base</span><span class="p">,</span> <span class="n">combination</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">K</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">combination</span> <span class="o">-</span> <span class="n">base</span><span class="p">))</span>

<span class="c1"># the 3rd loss function, total variation loss,</span>
<span class="c1"># designed to keep the generated image locally coherent</span>


<span class="k">def</span> <span class="nf">total_variation_loss</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">K</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
    <span class="k">if</span> <span class="n">K</span><span class="o">.</span><span class="n">image_data_format</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'channels_first'</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="n">img_nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">img_ncols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:</span><span class="n">img_ncols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="n">img_nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">img_ncols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="n">img_nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:</span><span class="n">img_nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">img_ncols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:</span><span class="n">img_ncols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="p">:</span><span class="n">img_nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">img_ncols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:,</span> <span class="p">:</span><span class="n">img_nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:])</span>
    <span class="k">return</span> <span class="n">K</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">))</span>

<span class="c1"># combine these loss functions into a single scalar</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
<span class="n">layer_features</span> <span class="o">=</span> <span class="n">outputs_dict</span><span class="p">[</span><span class="s1">'block4_conv2'</span><span class="p">]</span>
<span class="n">base_image_features</span> <span class="o">=</span> <span class="n">layer_features</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="n">combination_features</span> <span class="o">=</span> <span class="n">layer_features</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="n">loss</span> <span class="o">+=</span> <span class="n">content_weight</span> <span class="o">*</span> <span class="n">content_loss</span><span class="p">(</span><span class="n">base_image_features</span><span class="p">,</span>
                                      <span class="n">combination_features</span><span class="p">)</span>

<span class="n">feature_layers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'block1_conv1'</span><span class="p">,</span> <span class="s1">'block2_conv1'</span><span class="p">,</span>
                  <span class="s1">'block3_conv1'</span><span class="p">,</span> <span class="s1">'block4_conv1'</span><span class="p">,</span>
                  <span class="s1">'block5_conv1'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">layer_name</span> <span class="ow">in</span> <span class="n">feature_layers</span><span class="p">:</span>
    <span class="n">layer_features</span> <span class="o">=</span> <span class="n">outputs_dict</span><span class="p">[</span><span class="n">layer_name</span><span class="p">]</span>
    <span class="n">style_reference_features</span> <span class="o">=</span> <span class="n">layer_features</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>
    <span class="n">combination_features</span> <span class="o">=</span> <span class="n">layer_features</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span>
    <span class="n">sl</span> <span class="o">=</span> <span class="n">style_loss</span><span class="p">(</span><span class="n">style_reference_features</span><span class="p">,</span> <span class="n">combination_features</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">+=</span> <span class="p">(</span><span class="n">style_weight</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">feature_layers</span><span class="p">))</span> <span class="o">*</span> <span class="n">sl</span>
<span class="n">loss</span> <span class="o">+=</span> <span class="n">total_variation_weight</span> <span class="o">*</span> <span class="n">total_variation_loss</span><span class="p">(</span><span class="n">combination_image</span><span class="p">)</span>

<span class="c1"># get the gradients of the generated image wrt the loss</span>
<span class="n">grads</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gradients</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">combination_image</span><span class="p">)</span>

<span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">loss</span><span class="p">]</span>
<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grads</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
    <span class="n">outputs</span> <span class="o">+=</span> <span class="n">grads</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">outputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grads</span><span class="p">)</span>

<span class="n">f_outputs</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">function</span><span class="p">([</span><span class="n">combination_image</span><span class="p">],</span> <span class="n">outputs</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">eval_loss_and_grads</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">K</span><span class="o">.</span><span class="n">image_data_format</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'channels_first'</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">img_nrows</span><span class="p">,</span> <span class="n">img_ncols</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">img_nrows</span><span class="p">,</span> <span class="n">img_ncols</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">outs</span> <span class="o">=</span> <span class="n">f_outputs</span><span class="p">([</span><span class="n">x</span><span class="p">])</span>
    <span class="n">loss_value</span> <span class="o">=</span> <span class="n">outs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">outs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">grad_values</span> <span class="o">=</span> <span class="n">outs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float64'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">grad_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">outs</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float64'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">loss_value</span><span class="p">,</span> <span class="n">grad_values</span>

<span class="c1"># this Evaluator class makes it possible</span>
<span class="c1"># to compute loss and gradients in one pass</span>
<span class="c1"># while retrieving them via two separate functions,</span>
<span class="c1"># "loss" and "grads". This is done because scipy.optimize</span>
<span class="c1"># requires separate functions for loss and gradients,</span>
<span class="c1"># but computing them separately would be inefficient.</span>


<span class="k">class</span> <span class="nc">Evaluator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grads_values</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_value</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="n">loss_value</span><span class="p">,</span> <span class="n">grad_values</span> <span class="o">=</span> <span class="n">eval_loss_and_grads</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss_value</span> <span class="o">=</span> <span class="n">loss_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grad_values</span> <span class="o">=</span> <span class="n">grad_values</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_value</span>

    <span class="k">def</span> <span class="nf">grads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">grad_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grad_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grad_values</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">grad_values</span>

<span class="n">evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">()</span>

<span class="c1"># run scipy-based optimization (L-BFGS) over the pixels of the generated image</span>
<span class="c1"># so as to minimize the neural style loss</span>
<span class="k">if</span> <span class="n">K</span><span class="o">.</span><span class="n">image_data_format</span><span class="p">()</span> <span class="o">==</span> <span class="s1">'channels_first'</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">img_nrows</span><span class="p">,</span> <span class="n">img_ncols</span><span class="p">))</span> <span class="o">-</span> <span class="mf">128.</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">img_nrows</span><span class="p">,</span> <span class="n">img_ncols</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="mf">128.</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Start of iteration'</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">fmin_l_bfgs_b</span><span class="p">(</span><span class="n">evaluator</span><span class="o">.</span><span class="n">loss</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
                                     <span class="n">fprime</span><span class="o">=</span><span class="n">evaluator</span><span class="o">.</span><span class="n">grads</span><span class="p">,</span> <span class="n">maxfun</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Current loss value:'</span><span class="p">,</span> <span class="n">min_val</span><span class="p">)</span>
    <span class="c1"># save current generated image</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">deprocess_image</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">result_prefix</span> <span class="o">+</span> <span class="s1">'_at_iteration_</span><span class="si">%d</span><span class="s1">.png'</span> <span class="o">%</span> <span class="n">i</span>
    <span class="n">imsave</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Image saved as'</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'Iteration </span><span class="si">%d</span><span class="s1"> completed in </span><span class="si">%d</span><span class="s1">s'</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">))</span>
</code></pre></div><p>复制上述代码保存为neural_style_transfer.py(随便命名)</p><h2><b>4.运行</b></h2><p>新建一个空文件夹，把上一步骤的文件neural_style_transfer.py放入这个空文件夹中。然后把相应的模板图片，待转化图片放入该文件当中。</p><div class="highlight"><pre><code class="language-python3"><span></span><span class="n">python</span> <span class="n">neural_style_transfer</span><span class="o">.</span><span class="n">py</span>   <span class="n">你的待转化图片路径</span>    <span class="n">模板图片路径</span>   <span class="n">保存的生产图片路径加名称</span><span class="err">（</span><span class="n">注意不需要有</span><span class="o">.</span><span class="n">jpg等后缀</span><span class="err">）</span>
 <span class="n">python</span> <span class="n">neural_style_transfer</span><span class="o">.</span><span class="n">py</span> <span class="s1">'./me.jpg'</span> <span class="s1">'./starry_night.jpg'</span> <span class="s1">'./me_t'</span>
</code></pre></div><p>迭代结果截图：</p><noscript><img src="https://pic3.zhimg.com/50/v2-7bd28bae3b546a72d56e0e3d568152b2_hd.png" data-rawwidth="484" data-rawheight="595" class="origin_image zh-lightbox-thumb" width="484" data-original="https://pic3.zhimg.com/v2-7bd28bae3b546a72d56e0e3d568152b2_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='484'%20height='595'&gt;&lt;/svg&gt;" data-rawwidth="484" data-rawheight="595" class="origin_image zh-lightbox-thumb lazy" width="484" data-original="https://pic3.zhimg.com/v2-7bd28bae3b546a72d56e0e3d568152b2_r.png" data-actualsrc="https://pic3.zhimg.com/50/v2-7bd28bae3b546a72d56e0e3d568152b2_hd.png"><h2><b>迭代过程对比</b></h2><noscript><img src="https://pic3.zhimg.com/50/v2-325064dfc72b82872a4a70a4f87ef1e6_hd.png" data-rawwidth="778" data-rawheight="496" class="origin_image zh-lightbox-thumb" width="778" data-original="https://pic3.zhimg.com/v2-325064dfc72b82872a4a70a4f87ef1e6_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='778'%20height='496'&gt;&lt;/svg&gt;" data-rawwidth="778" data-rawheight="496" class="origin_image zh-lightbox-thumb lazy" width="778" data-original="https://pic3.zhimg.com/v2-325064dfc72b82872a4a70a4f87ef1e6_r.png" data-actualsrc="https://pic3.zhimg.com/50/v2-325064dfc72b82872a4a70a4f87ef1e6_hd.png"><br><h2><b>其它库实现风格转化</b></h2><p>基于python深度学习库DeepPy的实现：<a href="https://link.zhihu.com/?target=https%3A//github.com/andersbll/neural_artistic_style" class=" wrap external" target="_blank" rel="nofollow noreferrer">GitHub - andersbll/neural_artistic_style: Neural Artistic Style in Python<i class="icon-external"></i></a></p><p>基于python深度学习库TensorFlow的实现：<a href="https://link.zhihu.com/?target=https%3A//github.com/anishathalye/neural-style" class=" wrap external" target="_blank" rel="nofollow noreferrer">GitHub - anishathalye/neural-style: Neural style in TensorFlow!<i class="icon-external"></i></a></p><p>基于python深度学习库Caffe的实现：<a href="https://link.zhihu.com/?target=https%3A//github.com/fzliu/style-transfer" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/fzliu/style-</span><span class="invisible">transfer</span><span class="ellipsis"></span><i class="icon-external"></i></a></p></span></div><div><div class="ContentItem-time"><a target="_blank" href="/question/21395276/answer/115805610"><span data-tooltip="发布于 2016-08-09">编辑于 2017-05-01</span></a></div></div><div class="ContentItem-actions RichContent-actions"><span><button class="Button VoteButton VoteButton--up" aria-label="赞同" type="button"><svg viewBox="0 0 20 18" class="Icon VoteButton-upIcon Icon--triangle" style="height:16px;width:9px;" width="9" height="16" aria-hidden="true"><title></title><g><path d="M0 15.243c0-.326.088-.533.236-.896l7.98-13.204C8.57.57 9.086 0 10 0s1.43.57 1.784 1.143l7.98 13.204c.15.363.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H1.955c-1.08 0-1.955-.517-1.955-1.9z"/></g></svg>2.7K</button><button class="Button VoteButton VoteButton--down" aria-label="反对" type="button"><svg viewBox="0 0 20 18" class="Icon VoteButton-downIcon Icon--triangle" style="height:16px;width:9px;" width="9" height="16" aria-hidden="true"><title></title><g><path d="M0 15.243c0-.326.088-.533.236-.896l7.98-13.204C8.57.57 9.086 0 10 0s1.43.57 1.784 1.143l7.98 13.204c.15.363.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H1.955c-1.08 0-1.955-.517-1.955-1.9z"/></g></svg></button></span><button class="Button ContentItem-action Button--plain" type="button"><svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--comment Icon--left" style="height:16px;width:12px;" width="12" height="16" aria-hidden="true"><title></title><g><path d="M7.24 16.313c-.272-.047-.553.026-.77.2-1.106.813-2.406 1.324-3.77 1.482-.16.017-.313-.06-.394-.197-.082-.136-.077-.308.012-.44.528-.656.906-1.42 1.11-2.237.04-.222-.046-.45-.226-.588C1.212 13.052.027 10.73 0 8.25 0 3.7 4.03 0 9 0s9 3.7 9 8.25-4.373 9.108-10.76 8.063z"/></g></svg>418 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="" id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button class="Button Button--plain" type="button"><svg viewBox="0 0 20 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--share Icon--left" style="height:16px;width:13px;" width="13" height="16" aria-hidden="true"><title></title><g><path d="M.93 3.89C-.135 4.13-.343 5.56.614 6.098L5.89 9.005l8.168-4.776c.25-.128.477.197.273.388L7.05 10.66l.926 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.243c.584-.892-.212-2.03-1.234-1.796L.93 3.89z"/></g></svg>分享</button></div></div><button class="Button ContentItem-action Button--plain" type="button"><svg viewBox="0 0 20 20" class="Icon Icon--star Icon--left" style="height:16px;width:13px;" width="13" height="16" aria-hidden="true"><title></title><g><path d="M3.515 17.64l.918-5.355-3.89-3.792c-.926-.902-.64-1.784.64-1.97L6.56 5.74 8.964.87c.572-1.16 1.5-1.16 2.072 0l2.404 4.87 5.377.783c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.22 1.274-.532 1.82-1.676 1.218L10 16.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z"/></g></svg>收藏</button><button class="Button ContentItem-action Button--plain" type="button"><svg width="14" height="16" viewBox="0 0 20 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--thank Icon--left" style="height:16px;width:14px;" aria-hidden="true"><title></title><g><path d="M0 5.437C0 2.505 2.294.094 5.207 0 7.243 0 9.092 1.19 10 3c.823-1.758 2.65-3 4.65-3C17.546 0 20 2.507 20 5.432 20 13.24 11.842 18 10 18 8.158 18 0 13.24 0 5.437z" fill-rule="evenodd"/></g></svg>感谢</button><button class="Button ContentItem-action ContentItem-rightButton Button--plain" data-zop-retract-question="true" type="button"><span class="RichContent-collapsedText">收起</span><svg viewBox="0 0 10 6" class="Icon ContentItem-arrowIcon is-active Icon--arrow" style="height:16px;width:10px;" width="10" height="16" aria-hidden="true"><title></title><g><path d="M8.716.217L5.002 4 1.285.218C.99-.072.514-.072.22.218c-.294.29-.294.76 0 1.052l4.25 4.512c.292.29.77.29 1.063 0L9.78 1.27c.293-.29.293-.76 0-1.052-.295-.29-.77-.29-1.063 0z"/></g></svg></button></div></div></div></div><div class="List-item"><div class="ContentItem AnswerItem" data-za-index="1" data-zop="{&quot;authorName&quot;:&quot;张子琦&quot;,&quot;itemId&quot;:74966923,&quot;title&quot;:&quot;可以用 Python 编程语言做哪些神奇好玩的事情？&quot;,&quot;type&quot;:&quot;answer&quot;}" name="74966923" itemprop="suggestedAnswer" itemtype="http://schema.org/Answer" itemscope=""><div class="ContentItem-meta"><div class="AnswerItem-meta AnswerItem-meta--related"><div class="AuthorInfo" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="张子琦"/><meta itemprop="image" content="https://pic1.zhimg.com/50/v2-4c5331c324eca4c26ae433a09c17c54c_hd.jpg"/><meta itemprop="url" content="https://www.zhihu.com/people/zhangziqi"/><meta itemprop="zhihu:followerCount" content="751"/><span class="UserLink AuthorInfo-avatarWrapper"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><a class="UserLink-link" data-za-detail-view-element_name="User" href="/people/zhangziqi"><img class="Avatar AuthorInfo-avatar" width="38" height="38" src="https://pic1.zhimg.com/50/v2-4c5331c324eca4c26ae433a09c17c54c_xs.jpg" srcset="https://pic1.zhimg.com/50/v2-4c5331c324eca4c26ae433a09c17c54c_l.jpg 2x" alt="张子琦"/></a></div></div></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><a class="UserLink-link" data-za-detail-view-element_name="User" href="/people/zhangziqi">张子琦</a></div></div></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="RichText AuthorInfo-badgeText">逆向工程、漏洞挖掘、代码审计、不务正业</div></div></div></div></div><div class="AnswerItem-extraInfo"><span class="Voters"><button class="Button Button--plain" type="button">2049 人赞同了该回答</button></span></div></div></div><meta itemprop="image" content="https://pic2.zhimg.com/d309687b7d91eb1d98288e0cd6c326b5_200x112.jpg"/><meta itemprop="upvoteCount" content="2049"/><meta itemprop="url" content="https://www.zhihu.com/question/21395276/answer/74966923"/><meta itemprop="dateCreated" content="2015-12-02T13:27:06.000Z"/><meta itemprop="dateModified" content="2016-07-01T13:21:22.000Z"/><meta itemprop="commentCount" content="220"/><div class="RichContent RichContent--unescapable"><div class="RichContent-inner"><span class="RichText CopyrightRichText-richText" itemprop="text">大一刚学Python的时候，写了一只12306爬虫，采集车次、时刻表数据<br>多线程采集，经过不断调试终于稳定，速度也还可以<br>每天大概可以采集到2000多个车站，5000多个车次，5万多条时刻信息（这些信息每天都在变的，所以要设置不同日期，然后保存）<br><br>当然这不算有意思的<br><br>有意思的是这个<br><noscript><img src="https://pic2.zhimg.com/50/d309687b7d91eb1d98288e0cd6c326b5_hd.png" data-rawwidth="1872" data-rawheight="913" class="origin_image zh-lightbox-thumb" width="1872" data-original="https://pic2.zhimg.com/d309687b7d91eb1d98288e0cd6c326b5_r.png">可以可视化显示各个站点不同时间的车辆运行情况（当然显示部分不是用Python写的了）</noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='1872'%20height='913'&gt;&lt;/svg&gt;" data-rawwidth="1872" data-rawheight="913" class="origin_image zh-lightbox-thumb lazy" width="1872" data-original="https://pic2.zhimg.com/d309687b7d91eb1d98288e0cd6c326b5_r.png" data-actualsrc="https://pic2.zhimg.com/50/d309687b7d91eb1d98288e0cd6c326b5_hd.png">可以可视化显示各个站点不同时间的车辆运行情况（当然显示部分不是用Python写的了）<br><br>采集了这么多数据不利用就太可惜了，于是动了点脑筋，把数据利用起来，就有了下面这些（下面就与Python无关了）<br><br>那个时候铁道部还没有发布官网的购票APP，于是有了这个<br><noscript><img src="https://pic1.zhimg.com/50/d61f7892158fb4e558d7e0e1faadadbc_hd.png" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb" width="480" data-original="https://pic1.zhimg.com/d61f7892158fb4e558d7e0e1faadadbc_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='480'%20height='854'&gt;&lt;/svg&gt;" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb lazy" width="480" data-original="https://pic1.zhimg.com/d61f7892158fb4e558d7e0e1faadadbc_r.png" data-actualsrc="https://pic1.zhimg.com/50/d61f7892158fb4e558d7e0e1faadadbc_hd.png"><br><br><noscript><img src="https://pic3.zhimg.com/50/dccc2516fa881baad61e417cf70d877e_hd.png" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb" width="480" data-original="https://pic3.zhimg.com/dccc2516fa881baad61e417cf70d877e_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='480'%20height='854'&gt;&lt;/svg&gt;" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb lazy" width="480" data-original="https://pic3.zhimg.com/dccc2516fa881baad61e417cf70d877e_r.png" data-actualsrc="https://pic3.zhimg.com/50/dccc2516fa881baad61e417cf70d877e_hd.png"><br><br>自己做了个订票的APP，可查询车次、时刻、余票、正晚点<br>（请忽略图上的水印，这个APP首发是在百度火车吧，懒得再重新截图了）<br><br>嗯，虽然当时没有官方的APP，但第三方的还不少，上面的功能也没什么新鲜的<br>不过下面几个功能一般的APP是没有的<br><br>车站详细信息查询，包括所在地址、是否办理旅客乘降、是否办理行包业务，也有一些非路内人士不会在意的信息，比如所属线路、所在路局、是否为接算站等等<br><noscript><img src="https://pic1.zhimg.com/50/d5c6ec36176125fbae64091b856bc7a0_hd.png" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb" width="480" data-original="https://pic1.zhimg.com/d5c6ec36176125fbae64091b856bc7a0_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='480'%20height='854'&gt;&lt;/svg&gt;" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb lazy" width="480" data-original="https://pic1.zhimg.com/d5c6ec36176125fbae64091b856bc7a0_r.png" data-actualsrc="https://pic1.zhimg.com/50/d5c6ec36176125fbae64091b856bc7a0_hd.png"><br><br><br>编组、乘务、套跑信息<br><noscript><img src="https://pic3.zhimg.com/50/063d93ac3ed2fd60fd0c2cb172abb80e_hd.png" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb" width="480" data-original="https://pic3.zhimg.com/063d93ac3ed2fd60fd0c2cb172abb80e_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='480'%20height='854'&gt;&lt;/svg&gt;" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb lazy" width="480" data-original="https://pic3.zhimg.com/063d93ac3ed2fd60fd0c2cb172abb80e_r.png" data-actualsrc="https://pic3.zhimg.com/50/063d93ac3ed2fd60fd0c2cb172abb80e_hd.png"><br><br>上面两个功能非路内人士应该不会用的太多，下面还有几个实用的功能<br><br><br>电话订票<br>在高峰时期订票电话经常打不通，其实这个是有些小技巧的，加拨同路局其它城市区号效果会好很多（当时电话订票是要拨打出发地所在路局的电话的，不知道现在是否实现了电话跨路局售票）<br><br><noscript><img src="https://pic3.zhimg.com/50/a41735db73fa28db405d1887d1eef4ea_hd.png" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb" width="480" data-original="https://pic3.zhimg.com/a41735db73fa28db405d1887d1eef4ea_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='480'%20height='854'&gt;&lt;/svg&gt;" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb lazy" width="480" data-original="https://pic3.zhimg.com/a41735db73fa28db405d1887d1eef4ea_r.png" data-actualsrc="https://pic3.zhimg.com/50/a41735db73fa28db405d1887d1eef4ea_hd.png"><br><br><br>座位分布，想刷靠窗座位就看这个吧<br><noscript><img src="https://pic2.zhimg.com/50/0dc9a23cb567b5f2a0b91b40435bc579_hd.png" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb" width="480" data-original="https://pic2.zhimg.com/0dc9a23cb567b5f2a0b91b40435bc579_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='480'%20height='854'&gt;&lt;/svg&gt;" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb lazy" width="480" data-original="https://pic2.zhimg.com/0dc9a23cb567b5f2a0b91b40435bc579_r.png" data-actualsrc="https://pic2.zhimg.com/50/0dc9a23cb567b5f2a0b91b40435bc579_hd.png"><br><br><br><br>根据二维码验票真伪<br><p>将来的你一定会感谢今天拼命努力的你 (二维码自动识别)</p><br><br><br>放票时间查询<br><noscript><img src="https://pic1.zhimg.com/50/3e441e822d5c09ab670072b33acd2a50_hd.png" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb" width="480" data-original="https://pic1.zhimg.com/3e441e822d5c09ab670072b33acd2a50_r.png"></noscript><img src="data:image/svg+xml;utf8,&lt;svg%20xmlns='http://www.w3.org/2000/svg'%20width='480'%20height='854'&gt;&lt;/svg&gt;" data-rawwidth="480" data-rawheight="854" class="origin_image zh-lightbox-thumb lazy" width="480" data-original="https://pic1.zhimg.com/3e441e822d5c09ab670072b33acd2a50_r.png" data-actualsrc="https://pic1.zhimg.com/50/3e441e822d5c09ab670072b33acd2a50_hd.png"><br>界面丑的要死，请大家忽略界面吧。。<br><br>以上</span></div><div><div class="ContentItem-time"><a target="_blank" href="/question/21395276/answer/74966923"><span data-tooltip="发布于 2015-12-02">编辑于 2016-07-01</span></a></div></div><div class="ContentItem-actions RichContent-actions"><span><button class="Button VoteButton VoteButton--up" aria-label="赞同" type="button"><svg viewBox="0 0 20 18" class="Icon VoteButton-upIcon Icon--triangle" style="height:16px;width:9px;" width="9" height="16" aria-hidden="true"><title></title><g><path d="M0 15.243c0-.326.088-.533.236-.896l7.98-13.204C8.57.57 9.086 0 10 0s1.43.57 1.784 1.143l7.98 13.204c.15.363.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H1.955c-1.08 0-1.955-.517-1.955-1.9z"/></g></svg>2.0K</button><button class="Button VoteButton VoteButton--down" aria-label="反对" type="button"><svg viewBox="0 0 20 18" class="Icon VoteButton-downIcon Icon--triangle" style="height:16px;width:9px;" width="9" height="16" aria-hidden="true"><title></title><g><path d="M0 15.243c0-.326.088-.533.236-.896l7.98-13.204C8.57.57 9.086 0 10 0s1.43.57 1.784 1.143l7.98 13.204c.15.363.236.57.236.896 0 1.386-.875 1.9-1.955 1.9H1.955c-1.08 0-1.955-.517-1.955-1.9z"/></g></svg></button></span><button class="Button ContentItem-action Button--plain" type="button"><svg viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--comment Icon--left" style="height:16px;width:12px;" width="12" height="16" aria-hidden="true"><title></title><g><path d="M7.24 16.313c-.272-.047-.553.026-.77.2-1.106.813-2.406 1.324-3.77 1.482-.16.017-.313-.06-.394-.197-.082-.136-.077-.308.012-.44.528-.656.906-1.42 1.11-2.237.04-.222-.046-.45-.226-.588C1.212 13.052.027 10.73 0 8.25 0 3.7 4.03 0 9 0s9 3.7 9 8.25-4.373 9.108-10.76 8.063z"/></g></svg>220 条评论</button><div class="Popover ShareMenu ContentItem-action"><div class="" id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button class="Button Button--plain" type="button"><svg viewBox="0 0 20 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--share Icon--left" style="height:16px;width:13px;" width="13" height="16" aria-hidden="true"><title></title><g><path d="M.93 3.89C-.135 4.13-.343 5.56.614 6.098L5.89 9.005l8.168-4.776c.25-.128.477.197.273.388L7.05 10.66l.926 5.953c.18 1.084 1.593 1.376 2.182.456l9.644-15.243c.584-.892-.212-2.03-1.234-1.796L.93 3.89z"/></g></svg>分享</button></div></div><button class="Button ContentItem-action Button--plain" type="button"><svg viewBox="0 0 20 20" class="Icon Icon--star Icon--left" style="height:16px;width:13px;" width="13" height="16" aria-hidden="true"><title></title><g><path d="M3.515 17.64l.918-5.355-3.89-3.792c-.926-.902-.64-1.784.64-1.97L6.56 5.74 8.964.87c.572-1.16 1.5-1.16 2.072 0l2.404 4.87 5.377.783c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.22 1.274-.532 1.82-1.676 1.218L10 16.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z"/></g></svg>收藏</button><button class="Button ContentItem-action Button--plain" type="button"><svg width="14" height="16" viewBox="0 0 20 18" xmlns="http://www.w3.org/2000/svg" class="Icon Icon--thank Icon--left" style="height:16px;width:14px;" aria-hidden="true"><title></title><g><path d="M0 5.437C0 2.505 2.294.094 5.207 0 7.243 0 9.092 1.19 10 3c.823-1.758 2.65-3 4.65-3C17.546 0 20 2.507 20 5.432 20 13.24 11.842 18 10 18 8.158 18 0 13.24 0 5.437z" fill-rule="evenodd"/></g></svg>感谢</button><button class="Button ContentItem-action ContentItem-rightButton Button--plain" data-zop-retract-question="true" type="button"><span class="RichContent-collapsedText">收起</span><svg viewBox="0 0 10 6" class="Icon ContentItem-arrowIcon is-active Icon--arrow" style="height:16px;width:10px;" width="10" height="16" aria-hidden="true"><title></title><g><path d="M8.716.217L5.002 4 1.285.218C.99-.072.514-.072.22.218c-.294.29-.294.76 0 1.052l4.25 4.512c.292.29.77.29 1.063 0L9.78 1.27c.293-.29.293-.76 0-1.052-.295-.29-.77-.29-1.063 0z"/></g></svg></button></div></div></div></div></div></div></div><div class="Card"><button class="Button QuestionMainAction" type="button">查看更多回答</button></div></div><div class="CollapsedAnswers-bar"><button class="Button Button--plain" type="button">17 个回答被折叠</button>（<a class="Button Button--plain" target="_blank" type="button" href="/question/20120168">为什么？</a>）</div></div></div></div></div></main></div></div><div id="data" style="display:none;" data-state="{&quot;loading&quot;:{&quot;global&quot;:{&quot;count&quot;:0},&quot;local&quot;:{&quot;token/&quot;:false,&quot;env/getExperiments/&quot;:false,&quot;config/getAppConfig/&quot;:false,&quot;question/get/&quot;:false,&quot;question/getAnswers/21395276&quot;:false}},&quot;entities&quot;:{&quot;users&quot;:{},&quot;questions&quot;:{&quot;21395276&quot;:{&quot;status&quot;:{&quot;isLocked&quot;:false,&quot;isClose&quot;:false,&quot;isEvaluate&quot;:false,&quot;isSuggest&quot;:false},&quot;relationship&quot;:{&quot;concernedFollowers&quot;:[],&quot;isAnonymous&quot;:false,&quot;canLock&quot;:false,&quot;isFollowing&quot;:false,&quot;isAuthor&quot;:false,&quot;canCollapseAnswers&quot;:false,&quot;canStickAnswers&quot;:false},&quot;isMuted&quot;:false,&quot;topics&quot;:[{&quot;introduction&quot;:&quot;软件开发是建造出软件系统或者系统中软件部分的一个产品开发的过程。&quot;,&quot;avatarUrl&quot;:&quot;https://pic2.zhimg.com/50/185d9c33d_hd.jpg&quot;,&quot;name&quot;:&quot;软件开发&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/topics/19552332&quot;,&quot;type&quot;:&quot;topic&quot;,&quot;excerpt&quot;:&quot;软件开发是建造出软件系统或者系统中软件部分的一个产品开发的过程。&quot;,&quot;id&quot;:&quot;19552332&quot;},{&quot;introduction&quot;:&quot;程序设计语言( &lt;a href=\&quot;http://en.wikipedia.org/wiki/Programming_language\&quot; data-editable=\&quot;true\&quot; data-title=\&quot;Programming languages\&quot; class=\&quot;\&quot;&gt;Programming Languages&lt;/a&gt; )又称编程语言，是一组用来定义计算机程序的语法规则。&quot;,&quot;avatarUrl&quot;:&quot;https://pic3.zhimg.com/50/13753a176_hd.jpg&quot;,&quot;name&quot;:&quot;编程语言&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/topics/19552826&quot;,&quot;type&quot;:&quot;topic&quot;,&quot;excerpt&quot;:&quot;程序设计语言( Programming Languages )又称编程语言，是一组用来定义计算机程序的语法规则。&quot;,&quot;id&quot;:&quot;19552826&quot;},{&quot;introduction&quot;:&quot;Python 是一种面向对象的解释型计算机程序设计语言，在设计中注重代码的可读性，同时也是一种功能强大的通用型语言。&quot;,&quot;avatarUrl&quot;:&quot;https://pic1.zhimg.com/50/3111ec1cc_hd.jpg&quot;,&quot;name&quot;:&quot;Python&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/topics/19552832&quot;,&quot;type&quot;:&quot;topic&quot;,&quot;excerpt&quot;:&quot;Python 是一种面向对象的解释型计算机程序设计语言，在设计中注重代码的可读性，同时也是一种功能强大的通用型语言。&quot;,&quot;id&quot;:&quot;19552832&quot;},{&quot;introduction&quot;:&quot;&quot;,&quot;avatarUrl&quot;:&quot;https://pic3.zhimg.com/50/8cb9eb0ea_hd.jpg&quot;,&quot;name&quot;:&quot;程序&quot;,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/topics/19565652&quot;,&quot;type&quot;:&quot;topic&quot;,&quot;excerpt&quot;:&quot;&quot;,&quot;id&quot;:&quot;19565652&quot;}],&quot;excerpt&quot;:&quot;请说明为什么这些事情适合用 Python 做。&quot;,&quot;adminClosedComment&quot;:false,&quot;isEditable&quot;:false,&quot;reviewInfo&quot;:{&quot;type&quot;:&quot;&quot;,&quot;tips&quot;:&quot;&quot;,&quot;editTips&quot;:&quot;&quot;,&quot;isReviewing&quot;:false},&quot;answerCount&quot;:170,&quot;editableDetail&quot;:&quot;请说明为什么这些事情适合用 Python 做。&quot;,&quot;visitCount&quot;:2008525,&quot;id&quot;:21395276,&quot;collapsedAnswerCount&quot;:17,&quot;author&quot;:{&quot;avatarUrlTemplate&quot;:&quot;https://pic3.zhimg.com/50/ad6d5e9a09ad21a8eb12a1e8728b8e56_hd.jpg&quot;,&quot;name&quot;:&quot;陈岳龙&quot;,&quot;headline&quot;:&quot;半个程序猿&quot;,&quot;gender&quot;:1,&quot;userType&quot;:&quot;people&quot;,&quot;urlToken&quot;:&quot;tamchen&quot;,&quot;isAdvertiser&quot;:false,&quot;avatarUrl&quot;:&quot;https://pic3.zhimg.com/50/ad6d5e9a09ad21a8eb12a1e8728b8e56_hd.jpg&quot;,&quot;isFollowing&quot;:false,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/people/1b932d4d932d3d71ed8e0829583da63a&quot;,&quot;type&quot;:&quot;people&quot;,&quot;badge&quot;:[],&quot;id&quot;:&quot;1b932d4d932d3d71ed8e0829583da63a&quot;,&quot;isOrg&quot;:false},&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/questions/21395276&quot;,&quot;commentPermission&quot;:&quot;all&quot;,&quot;created&quot;:1374990075,&quot;detail&quot;:&quot;请说明为什么这些事情适合用 Python 做。&quot;,&quot;updatedTime&quot;:1408256338,&quot;hasPublishingDraft&quot;:false,&quot;commentCount&quot;:7,&quot;questionType&quot;:&quot;normal&quot;,&quot;followerCount&quot;:25918,&quot;title&quot;:&quot;可以用 Python 编程语言做哪些神奇好玩的事情？&quot;,&quot;canComment&quot;:{&quot;status&quot;:true,&quot;reason&quot;:&quot;&quot;},&quot;type&quot;:&quot;question&quot;,&quot;isNormal&quot;:true}},&quot;answers&quot;:{&quot;18137210&quot;:{&quot;suggestEdit&quot;:{&quot;status&quot;:false,&quot;reason&quot;:&quot;&quot;,&quot;title&quot;:&quot;&quot;,&quot;url&quot;:&quot;&quot;,&quot;unnormalDetails&quot;:{},&quot;tip&quot;:&quot;&quot;},&quot;relationship&quot;:{&quot;upvotedFollowees&quot;:[],&quot;isAuthor&quot;:false,&quot;isNothelp&quot;:false,&quot;isAuthorized&quot;:false,&quot;voting&quot;:0,&quot;isThanked&quot;:false},&quot;editableContent&quot;:&quot;&quot;,&quot;markInfos&quot;:[],&quot;excerpt&quot;:&quot;国外有一位程序员 Kurt Grandis， 家里后院常常遭受松鼠小偷，于是乎他使用Python创造了一套智能武装系统：Kinect定位 -&amp;gt; OpenCV识别松鼠 -&amp;gt; Arduino控制水枪攻击。这是他在PyCon 2012的 Slide（墙外）： &lt;a href=\&quot;https://link.zhihu.com/?target=http%3A//www.slideshare.net/kgrandis/pycon-2012-militarizing-your-backyard-computer-vision-and-the-squirrel-hordes\&quot; class=\&quot; external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;&gt;&lt;span class=\&quot;invisible\&quot;&gt;http://www.&lt;/span&gt;&lt;span class=\&quot;visible\&quot;&gt;slideshare.net/kgrandis&lt;/span&gt;&lt;span class=\&quot;invisible\&quot;&gt;/pycon-2012-militarizing-your-backyard-computer-vision-and-the-squirrel-hordes&lt;/span&gt;&lt;span class=\&quot;ellipsis\&quot;&gt;&lt;/span&gt;&lt;i class=\&quot;icon-external\&quot;&gt;&lt;/i&gt;&lt;/a&gt;&quot;,&quot;annotationAction&quot;:[],&quot;adminClosedComment&quot;:false,&quot;collapsedBy&quot;:&quot;nobody&quot;,&quot;canComment&quot;:{&quot;status&quot;:true,&quot;reason&quot;:&quot;&quot;},&quot;createdTime&quot;:1375248653,&quot;id&quot;:18137210,&quot;voteupCount&quot;:1124,&quot;collapseReason&quot;:&quot;&quot;,&quot;isCollapsed&quot;:false,&quot;isSticky&quot;:false,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/answers/18137210&quot;,&quot;commentPermission&quot;:&quot;all&quot;,&quot;author&quot;:{&quot;avatarUrlTemplate&quot;:&quot;https://pic1.zhimg.com/50/d8ca4f09c_hd.jpg&quot;,&quot;name&quot;:&quot;杨二毛&quot;,&quot;headline&quot;:&quot;be a full stack developer&quot;,&quot;type&quot;:&quot;people&quot;,&quot;userType&quot;:&quot;people&quot;,&quot;urlToken&quot;:&quot;y2mao&quot;,&quot;isAdvertiser&quot;:false,&quot;avatarUrl&quot;:&quot;https://pic1.zhimg.com/50/d8ca4f09c_hd.jpg&quot;,&quot;isOrg&quot;:false,&quot;gender&quot;:1,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/people/ce0b20ea604de44fcaa62b8e05e4d78d&quot;,&quot;followerCount&quot;:561,&quot;badge&quot;:[],&quot;id&quot;:&quot;ce0b20ea604de44fcaa62b8e05e4d78d&quot;},&quot;question&quot;:{&quot;questionType&quot;:&quot;normal&quot;,&quot;created&quot;:1374990075,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/questions/21395276&quot;,&quot;title&quot;:&quot;可以用 Python 编程语言做哪些神奇好玩的事情？&quot;,&quot;type&quot;:&quot;question&quot;,&quot;id&quot;:21395276,&quot;updatedTime&quot;:1408256338},&quot;updatedTime&quot;:1375248653,&quot;content&quot;:&quot;国外有一位程序员 Kurt Grandis， 家里后院常常遭受松鼠小偷，于是乎他使用Python创造了一套智能武装系统：Kinect定位 -&amp;gt; OpenCV识别松鼠 -&amp;gt;  Arduino控制水枪攻击。这是他在PyCon 2012的 Slide（墙外）：&lt;br&gt;&lt;a href=\&quot;https://link.zhihu.com/?target=http%3A//www.slideshare.net/kgrandis/pycon-2012-militarizing-your-backyard-computer-vision-and-the-squirrel-hordes\&quot; class=\&quot; external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;&gt;&lt;span class=\&quot;invisible\&quot;&gt;http://www.&lt;/span&gt;&lt;span class=\&quot;visible\&quot;&gt;slideshare.net/kgrandis&lt;/span&gt;&lt;span class=\&quot;invisible\&quot;&gt;/pycon-2012-militarizing-your-backyard-computer-vision-and-the-squirrel-hordes&lt;/span&gt;&lt;span class=\&quot;ellipsis\&quot;&gt;&lt;/span&gt;&lt;i class=\&quot;icon-external\&quot;&gt;&lt;/i&gt;&lt;/a&gt;&quot;,&quot;commentCount&quot;:65,&quot;extras&quot;:&quot;&quot;,&quot;reshipmentSettings&quot;:&quot;allowed&quot;,&quot;rewardInfo&quot;:{&quot;rewardMemberCount&quot;:0,&quot;tagline&quot;:&quot;&quot;,&quot;rewardTotalMoney&quot;:0,&quot;canOpenReward&quot;:false,&quot;isRewardable&quot;:false},&quot;isCopyable&quot;:true,&quot;type&quot;:&quot;answer&quot;,&quot;thumbnail&quot;:&quot;&quot;,&quot;isNormal&quot;:true},&quot;74966923&quot;:{&quot;suggestEdit&quot;:{&quot;status&quot;:false,&quot;reason&quot;:&quot;&quot;,&quot;title&quot;:&quot;&quot;,&quot;url&quot;:&quot;&quot;,&quot;unnormalDetails&quot;:{},&quot;tip&quot;:&quot;&quot;},&quot;relationship&quot;:{&quot;upvotedFollowees&quot;:[],&quot;isAuthor&quot;:false,&quot;isNothelp&quot;:false,&quot;isAuthorized&quot;:false,&quot;voting&quot;:0,&quot;isThanked&quot;:false},&quot;editableContent&quot;:&quot;&quot;,&quot;markInfos&quot;:[],&quot;excerpt&quot;:&quot;大一刚学Python的时候，写了一只12306爬虫，采集车次、时刻表数据 多线程采集，经过不断调试终于稳定，速度也还可以 每天大概可以采集到2000多个车站，5000多个车次，5万多条时刻信息（这些信息每天都在变的，所以要设置不同日期，然后保存） 当然这不算有…&quot;,&quot;annotationAction&quot;:[],&quot;adminClosedComment&quot;:false,&quot;collapsedBy&quot;:&quot;nobody&quot;,&quot;canComment&quot;:{&quot;status&quot;:true,&quot;reason&quot;:&quot;&quot;},&quot;createdTime&quot;:1449062826,&quot;id&quot;:74966923,&quot;voteupCount&quot;:2049,&quot;collapseReason&quot;:&quot;&quot;,&quot;isCollapsed&quot;:false,&quot;isSticky&quot;:false,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/answers/74966923&quot;,&quot;commentPermission&quot;:&quot;all&quot;,&quot;author&quot;:{&quot;avatarUrlTemplate&quot;:&quot;https://pic1.zhimg.com/50/v2-4c5331c324eca4c26ae433a09c17c54c_hd.jpg&quot;,&quot;name&quot;:&quot;张子琦&quot;,&quot;headline&quot;:&quot;逆向工程、漏洞挖掘、代码审计、不务正业&quot;,&quot;type&quot;:&quot;people&quot;,&quot;userType&quot;:&quot;people&quot;,&quot;urlToken&quot;:&quot;zhangziqi&quot;,&quot;isAdvertiser&quot;:false,&quot;avatarUrl&quot;:&quot;https://pic1.zhimg.com/50/v2-4c5331c324eca4c26ae433a09c17c54c_hd.jpg&quot;,&quot;isOrg&quot;:false,&quot;gender&quot;:1,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/people/16a7db105ccce3b4dc8e57012ee80852&quot;,&quot;followerCount&quot;:751,&quot;badge&quot;:[],&quot;id&quot;:&quot;16a7db105ccce3b4dc8e57012ee80852&quot;},&quot;question&quot;:{&quot;questionType&quot;:&quot;normal&quot;,&quot;created&quot;:1374990075,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/questions/21395276&quot;,&quot;title&quot;:&quot;可以用 Python 编程语言做哪些神奇好玩的事情？&quot;,&quot;type&quot;:&quot;question&quot;,&quot;id&quot;:21395276,&quot;updatedTime&quot;:1408256338},&quot;updatedTime&quot;:1467379282,&quot;content&quot;:&quot;大一刚学Python的时候，写了一只12306爬虫，采集车次、时刻表数据&lt;br&gt;多线程采集，经过不断调试终于稳定，速度也还可以&lt;br&gt;每天大概可以采集到2000多个车站，5000多个车次，5万多条时刻信息（这些信息每天都在变的，所以要设置不同日期，然后保存）&lt;br&gt;&lt;br&gt;当然这不算有意思的&lt;br&gt;&lt;br&gt;有意思的是这个&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic2.zhimg.com/50/d309687b7d91eb1d98288e0cd6c326b5_hd.png\&quot; data-rawwidth=\&quot;1872\&quot; data-rawheight=\&quot;913\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;1872\&quot; data-original=\&quot;https://pic2.zhimg.com/d309687b7d91eb1d98288e0cd6c326b5_r.png\&quot;&gt;可以可视化显示各个站点不同时间的车辆运行情况（当然显示部分不是用Python写的了）&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;1872&#x27;%20height=&#x27;913&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;1872\&quot; data-rawheight=\&quot;913\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;1872\&quot; data-original=\&quot;https://pic2.zhimg.com/d309687b7d91eb1d98288e0cd6c326b5_r.png\&quot; data-actualsrc=\&quot;https://pic2.zhimg.com/50/d309687b7d91eb1d98288e0cd6c326b5_hd.png\&quot;&gt;可以可视化显示各个站点不同时间的车辆运行情况（当然显示部分不是用Python写的了）&lt;br&gt;&lt;br&gt;采集了这么多数据不利用就太可惜了，于是动了点脑筋，把数据利用起来，就有了下面这些（下面就与Python无关了）&lt;br&gt;&lt;br&gt;那个时候铁道部还没有发布官网的购票APP，于是有了这个&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic1.zhimg.com/50/d61f7892158fb4e558d7e0e1faadadbc_hd.png\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic1.zhimg.com/d61f7892158fb4e558d7e0e1faadadbc_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;480&#x27;%20height=&#x27;854&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic1.zhimg.com/d61f7892158fb4e558d7e0e1faadadbc_r.png\&quot; data-actualsrc=\&quot;https://pic1.zhimg.com/50/d61f7892158fb4e558d7e0e1faadadbc_hd.png\&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic3.zhimg.com/50/dccc2516fa881baad61e417cf70d877e_hd.png\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic3.zhimg.com/dccc2516fa881baad61e417cf70d877e_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;480&#x27;%20height=&#x27;854&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic3.zhimg.com/dccc2516fa881baad61e417cf70d877e_r.png\&quot; data-actualsrc=\&quot;https://pic3.zhimg.com/50/dccc2516fa881baad61e417cf70d877e_hd.png\&quot;&gt;&lt;br&gt;&lt;br&gt;自己做了个订票的APP，可查询车次、时刻、余票、正晚点&lt;br&gt;（请忽略图上的水印，这个APP首发是在百度火车吧，懒得再重新截图了）&lt;br&gt;&lt;br&gt;嗯，虽然当时没有官方的APP，但第三方的还不少，上面的功能也没什么新鲜的&lt;br&gt;不过下面几个功能一般的APP是没有的&lt;br&gt;&lt;br&gt;车站详细信息查询，包括所在地址、是否办理旅客乘降、是否办理行包业务，也有一些非路内人士不会在意的信息，比如所属线路、所在路局、是否为接算站等等&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic1.zhimg.com/50/d5c6ec36176125fbae64091b856bc7a0_hd.png\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic1.zhimg.com/d5c6ec36176125fbae64091b856bc7a0_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;480&#x27;%20height=&#x27;854&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic1.zhimg.com/d5c6ec36176125fbae64091b856bc7a0_r.png\&quot; data-actualsrc=\&quot;https://pic1.zhimg.com/50/d5c6ec36176125fbae64091b856bc7a0_hd.png\&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;编组、乘务、套跑信息&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic3.zhimg.com/50/063d93ac3ed2fd60fd0c2cb172abb80e_hd.png\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic3.zhimg.com/063d93ac3ed2fd60fd0c2cb172abb80e_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;480&#x27;%20height=&#x27;854&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic3.zhimg.com/063d93ac3ed2fd60fd0c2cb172abb80e_r.png\&quot; data-actualsrc=\&quot;https://pic3.zhimg.com/50/063d93ac3ed2fd60fd0c2cb172abb80e_hd.png\&quot;&gt;&lt;br&gt;&lt;br&gt;上面两个功能非路内人士应该不会用的太多，下面还有几个实用的功能&lt;br&gt;&lt;br&gt;&lt;br&gt;电话订票&lt;br&gt;在高峰时期订票电话经常打不通，其实这个是有些小技巧的，加拨同路局其它城市区号效果会好很多（当时电话订票是要拨打出发地所在路局的电话的，不知道现在是否实现了电话跨路局售票）&lt;br&gt;&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic3.zhimg.com/50/a41735db73fa28db405d1887d1eef4ea_hd.png\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic3.zhimg.com/a41735db73fa28db405d1887d1eef4ea_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;480&#x27;%20height=&#x27;854&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic3.zhimg.com/a41735db73fa28db405d1887d1eef4ea_r.png\&quot; data-actualsrc=\&quot;https://pic3.zhimg.com/50/a41735db73fa28db405d1887d1eef4ea_hd.png\&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;座位分布，想刷靠窗座位就看这个吧&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic2.zhimg.com/50/0dc9a23cb567b5f2a0b91b40435bc579_hd.png\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic2.zhimg.com/0dc9a23cb567b5f2a0b91b40435bc579_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;480&#x27;%20height=&#x27;854&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic2.zhimg.com/0dc9a23cb567b5f2a0b91b40435bc579_r.png\&quot; data-actualsrc=\&quot;https://pic2.zhimg.com/50/0dc9a23cb567b5f2a0b91b40435bc579_hd.png\&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;根据二维码验票真伪&lt;br&gt;&lt;p&gt;将来的你一定会感谢今天拼命努力的你 (二维码自动识别)&lt;/p&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;放票时间查询&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic1.zhimg.com/50/3e441e822d5c09ab670072b33acd2a50_hd.png\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic1.zhimg.com/3e441e822d5c09ab670072b33acd2a50_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;480&#x27;%20height=&#x27;854&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;480\&quot; data-rawheight=\&quot;854\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;480\&quot; data-original=\&quot;https://pic1.zhimg.com/3e441e822d5c09ab670072b33acd2a50_r.png\&quot; data-actualsrc=\&quot;https://pic1.zhimg.com/50/3e441e822d5c09ab670072b33acd2a50_hd.png\&quot;&gt;&lt;br&gt;界面丑的要死，请大家忽略界面吧。。&lt;br&gt;&lt;br&gt;以上&quot;,&quot;commentCount&quot;:220,&quot;extras&quot;:&quot;&quot;,&quot;reshipmentSettings&quot;:&quot;allowed&quot;,&quot;rewardInfo&quot;:{&quot;rewardMemberCount&quot;:0,&quot;tagline&quot;:&quot;&quot;,&quot;rewardTotalMoney&quot;:0,&quot;canOpenReward&quot;:false,&quot;isRewardable&quot;:false},&quot;isCopyable&quot;:true,&quot;type&quot;:&quot;answer&quot;,&quot;thumbnail&quot;:&quot;https://pic2.zhimg.com/d309687b7d91eb1d98288e0cd6c326b5_200x112.jpg&quot;,&quot;isNormal&quot;:true},&quot;115805610&quot;:{&quot;suggestEdit&quot;:{&quot;status&quot;:false,&quot;reason&quot;:&quot;&quot;,&quot;title&quot;:&quot;&quot;,&quot;url&quot;:&quot;&quot;,&quot;unnormalDetails&quot;:{},&quot;tip&quot;:&quot;&quot;},&quot;relationship&quot;:{&quot;upvotedFollowees&quot;:[],&quot;isAuthor&quot;:false,&quot;isNothelp&quot;:false,&quot;isAuthorized&quot;:false,&quot;voting&quot;:0,&quot;isThanked&quot;:false},&quot;editableContent&quot;:&quot;&quot;,&quot;markInfos&quot;:[],&quot;excerpt&quot;:&quot;&lt;u&gt;&lt;b&gt;可以画画啊！可以画画啊！可以画画啊！&lt;/b&gt;&lt;/u&gt; 对，有趣的事情需要讲三遍。\n事情是这样的，通过python的深度学习算法包去训练计算机模仿世界名画的风格，然后应用到另一幅画中，不多说直接上图！ 这个是世界名画”&lt;i&gt;毕加索的自画像&lt;/i&gt;“（我也不懂什么是世界名画，但是…&quot;,&quot;annotationAction&quot;:[],&quot;adminClosedComment&quot;:false,&quot;collapsedBy&quot;:&quot;nobody&quot;,&quot;canComment&quot;:{&quot;status&quot;:true,&quot;reason&quot;:&quot;&quot;},&quot;createdTime&quot;:1470707951,&quot;id&quot;:115805610,&quot;voteupCount&quot;:2651,&quot;collapseReason&quot;:&quot;&quot;,&quot;isCollapsed&quot;:false,&quot;isSticky&quot;:false,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/answers/115805610&quot;,&quot;commentPermission&quot;:&quot;all&quot;,&quot;author&quot;:{&quot;avatarUrlTemplate&quot;:&quot;https://pic3.zhimg.com/50/910388ae59c4403bbc9fc847fd629e76_hd.jpg&quot;,&quot;name&quot;:&quot;杨航锋&quot;,&quot;headline&quot;:&quot;机器学习/数据爱好者/Pythoner&quot;,&quot;type&quot;:&quot;people&quot;,&quot;userType&quot;:&quot;people&quot;,&quot;urlToken&quot;:&quot;zhi-mu-qing-yang&quot;,&quot;isAdvertiser&quot;:false,&quot;avatarUrl&quot;:&quot;https://pic3.zhimg.com/50/910388ae59c4403bbc9fc847fd629e76_hd.jpg&quot;,&quot;isOrg&quot;:false,&quot;gender&quot;:1,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/people/a9997a756b1a75464a0ef9ef0f9109a7&quot;,&quot;followerCount&quot;:2890,&quot;badge&quot;:[],&quot;id&quot;:&quot;a9997a756b1a75464a0ef9ef0f9109a7&quot;},&quot;question&quot;:{&quot;questionType&quot;:&quot;normal&quot;,&quot;created&quot;:1374990075,&quot;url&quot;:&quot;http://www.zhihu.com/api/v4/questions/21395276&quot;,&quot;title&quot;:&quot;可以用 Python 编程语言做哪些神奇好玩的事情？&quot;,&quot;type&quot;:&quot;question&quot;,&quot;id&quot;:21395276,&quot;updatedTime&quot;:1408256338},&quot;updatedTime&quot;:1493629000,&quot;content&quot;:&quot;&lt;p&gt;&lt;u&gt;&lt;b&gt;可以画画啊！可以画画啊！可以画画啊！&lt;/b&gt;&lt;/u&gt; 对，有趣的事情需要讲三遍。\n事情是这样的，通过python的深度学习算法包去训练计算机模仿世界名画的风格，然后应用到另一幅画中，不多说直接上图！&lt;/p&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic3.zhimg.com/50/98cab4f35d2084f969a8189e90b47dee_hd.jpg\&quot; data-rawwidth=\&quot;468\&quot; data-rawheight=\&quot;600\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;468\&quot; data-original=\&quot;https://pic3.zhimg.com/98cab4f35d2084f969a8189e90b47dee_r.jpg\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;468&#x27;%20height=&#x27;600&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;468\&quot; data-rawheight=\&quot;600\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;468\&quot; data-original=\&quot;https://pic3.zhimg.com/98cab4f35d2084f969a8189e90b47dee_r.jpg\&quot; data-actualsrc=\&quot;https://pic3.zhimg.com/50/98cab4f35d2084f969a8189e90b47dee_hd.jpg\&quot;&gt;&lt;br&gt;&lt;p&gt;这个是世界名画”&lt;i&gt;毕加索的自画像&lt;/i&gt;“（我也不懂什么是世界名画，但是我会google呀哈哈），以这张图片为模板，让计算机去学习这张图片的风格（至于怎么学习请参照这篇国外大牛的论文&lt;a href=\&quot;https://link.zhihu.com/?target=http%3A//arxiv.org/abs/1508.06576\&quot; class=\&quot; external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;&gt;&lt;span class=\&quot;invisible\&quot;&gt;http://&lt;/span&gt;&lt;span class=\&quot;visible\&quot;&gt;arxiv.org/abs/1508.0657&lt;/span&gt;&lt;span class=\&quot;invisible\&quot;&gt;6&lt;/span&gt;&lt;span class=\&quot;ellipsis\&quot;&gt;&lt;/span&gt;&lt;i class=\&quot;icon-external\&quot;&gt;&lt;/i&gt;&lt;/a&gt;）应用到自己的这张图片上。&lt;/p&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic2.zhimg.com/50/7ca4eb6c6088ad9880a4bc1a9993ed35_hd.jpg\&quot; data-rawwidth=\&quot;249\&quot; data-rawheight=\&quot;365\&quot; class=\&quot;content_image\&quot; width=\&quot;249\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;249&#x27;%20height=&#x27;365&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;249\&quot; data-rawheight=\&quot;365\&quot; class=\&quot;content_image lazy\&quot; width=\&quot;249\&quot; data-actualsrc=\&quot;https://pic2.zhimg.com/50/7ca4eb6c6088ad9880a4bc1a9993ed35_hd.jpg\&quot;&gt;&lt;p&gt;结果就变成下面这个样子了&lt;/p&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic1.zhimg.com/50/b869feb93320634a2c05752efd02bc74_hd.png\&quot; data-rawwidth=\&quot;472\&quot; data-rawheight=\&quot;660\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;472\&quot; data-original=\&quot;https://pic1.zhimg.com/b869feb93320634a2c05752efd02bc74_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;472&#x27;%20height=&#x27;660&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;472\&quot; data-rawheight=\&quot;660\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;472\&quot; data-original=\&quot;https://pic1.zhimg.com/b869feb93320634a2c05752efd02bc74_r.png\&quot; data-actualsrc=\&quot;https://pic1.zhimg.com/50/b869feb93320634a2c05752efd02bc74_hd.png\&quot;&gt;&lt;br&gt;&lt;p&gt;咦，吓死宝宝了，不过好玩的东西当然要身先士卒啦！\n接着由于距离开学也越来越近了，为了给广大新生营造一个良好的校园，噗！为了美化校园在新生心目中的形象学长真的不是有意要欺骗你们的。特意制作了下面的《梵高笔下的东华理工大学》，是不是没有听说过这个大学，的确她就是一个普通的二本学校不过这都不是重点。\n左边的图片是梵高的《星空》作为模板，中间的图片是待转化的图片，右边的图片是结果&lt;/p&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic2.zhimg.com/50/16b2c1522cea0ae43c4d2c1cc6871b29_hd.png\&quot; data-rawwidth=\&quot;852\&quot; data-rawheight=\&quot;172\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;852\&quot; data-original=\&quot;https://pic2.zhimg.com/16b2c1522cea0ae43c4d2c1cc6871b29_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;852&#x27;%20height=&#x27;172&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;852\&quot; data-rawheight=\&quot;172\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;852\&quot; data-original=\&quot;https://pic2.zhimg.com/16b2c1522cea0ae43c4d2c1cc6871b29_r.png\&quot; data-actualsrc=\&quot;https://pic2.zhimg.com/50/16b2c1522cea0ae43c4d2c1cc6871b29_hd.png\&quot;&gt;&lt;p&gt;这是我们学校的内“湖”（池塘）&lt;/p&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic1.zhimg.com/50/193695070e8614fb75b4735ad2d68734_hd.png\&quot; data-rawwidth=\&quot;856\&quot; data-rawheight=\&quot;173\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;856\&quot; data-original=\&quot;https://pic1.zhimg.com/193695070e8614fb75b4735ad2d68734_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;856&#x27;%20height=&#x27;173&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;856\&quot; data-rawheight=\&quot;173\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;856\&quot; data-original=\&quot;https://pic1.zhimg.com/193695070e8614fb75b4735ad2d68734_r.png\&quot; data-actualsrc=\&quot;https://pic1.zhimg.com/50/193695070e8614fb75b4735ad2d68734_hd.png\&quot;&gt;&lt;p&gt;校园里的樱花广场（个人觉得这是我校最浪漫的地方了）&lt;/p&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic3.zhimg.com/50/dd333413cb332f5d0681ba479249f802_hd.png\&quot; data-rawwidth=\&quot;848\&quot; data-rawheight=\&quot;206\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;848\&quot; data-original=\&quot;https://pic3.zhimg.com/dd333413cb332f5d0681ba479249f802_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;848&#x27;%20height=&#x27;206&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;848\&quot; data-rawheight=\&quot;206\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;848\&quot; data-original=\&quot;https://pic3.zhimg.com/dd333413cb332f5d0681ba479249f802_r.png\&quot; data-actualsrc=\&quot;https://pic3.zhimg.com/50/dd333413cb332f5d0681ba479249f802_hd.png\&quot;&gt;&lt;p&gt;不多说，学校图书馆&lt;/p&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic4.zhimg.com/50/9029082a8fdb697873f7250d0137a617_hd.png\&quot; data-rawwidth=\&quot;851\&quot; data-rawheight=\&quot;194\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;851\&quot; data-original=\&quot;https://pic4.zhimg.com/9029082a8fdb697873f7250d0137a617_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;851&#x27;%20height=&#x27;194&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;851\&quot; data-rawheight=\&quot;194\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;851\&quot; data-original=\&quot;https://pic4.zhimg.com/9029082a8fdb697873f7250d0137a617_r.png\&quot; data-actualsrc=\&quot;https://pic4.zhimg.com/50/9029082a8fdb697873f7250d0137a617_hd.png\&quot;&gt;&lt;p&gt;“池塘”边的柳树&lt;/p&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic1.zhimg.com/50/8d8dcbca85b62f276129d6d237d4d6fc_hd.png\&quot; data-rawwidth=\&quot;852\&quot; data-rawheight=\&quot;204\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;852\&quot; data-original=\&quot;https://pic1.zhimg.com/8d8dcbca85b62f276129d6d237d4d6fc_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;852&#x27;%20height=&#x27;204&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;852\&quot; data-rawheight=\&quot;204\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;852\&quot; data-original=\&quot;https://pic1.zhimg.com/8d8dcbca85b62f276129d6d237d4d6fc_r.png\&quot; data-actualsrc=\&quot;https://pic1.zhimg.com/50/8d8dcbca85b62f276129d6d237d4d6fc_hd.png\&quot;&gt;&lt;p&gt;学校东大门&lt;/p&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic1.zhimg.com/50/ad22383f37f56d92517b18bb830ee7c8_hd.png\&quot; data-rawwidth=\&quot;862\&quot; data-rawheight=\&quot;164\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;862\&quot; data-original=\&quot;https://pic1.zhimg.com/ad22383f37f56d92517b18bb830ee7c8_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;862&#x27;%20height=&#x27;164&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;862\&quot; data-rawheight=\&quot;164\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;862\&quot; data-original=\&quot;https://pic1.zhimg.com/ad22383f37f56d92517b18bb830ee7c8_r.png\&quot; data-actualsrc=\&quot;https://pic1.zhimg.com/50/ad22383f37f56d92517b18bb830ee7c8_hd.png\&quot;&gt;&lt;p&gt;学校测绘楼&lt;/p&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic3.zhimg.com/50/cb6d76286324c857528892014d04bb3e_hd.png\&quot; data-rawwidth=\&quot;852\&quot; data-rawheight=\&quot;211\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;852\&quot; data-original=\&quot;https://pic3.zhimg.com/cb6d76286324c857528892014d04bb3e_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;852&#x27;%20height=&#x27;211&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;852\&quot; data-rawheight=\&quot;211\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;852\&quot; data-original=\&quot;https://pic3.zhimg.com/cb6d76286324c857528892014d04bb3e_r.png\&quot; data-actualsrc=\&quot;https://pic3.zhimg.com/50/cb6d76286324c857528892014d04bb3e_hd.png\&quot;&gt;&lt;p&gt;学校地学楼&lt;/p&gt;&lt;p&gt;为了便于观看，附上生成后的大图：&lt;/p&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic3.zhimg.com/50/d7ee30ae90b3d81049abee478e8e75b6_hd.png\&quot; data-rawwidth=\&quot;699\&quot; data-rawheight=\&quot;408\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;699\&quot; data-original=\&quot;https://pic3.zhimg.com/d7ee30ae90b3d81049abee478e8e75b6_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;699&#x27;%20height=&#x27;408&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;699\&quot; data-rawheight=\&quot;408\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;699\&quot; data-original=\&quot;https://pic3.zhimg.com/d7ee30ae90b3d81049abee478e8e75b6_r.png\&quot; data-actualsrc=\&quot;https://pic3.zhimg.com/50/d7ee30ae90b3d81049abee478e8e75b6_hd.png\&quot;&gt;&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic3.zhimg.com/50/c04d56309b493bd2a0d3db26d0916206_hd.png\&quot; data-rawwidth=\&quot;700\&quot; data-rawheight=\&quot;465\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;700\&quot; data-original=\&quot;https://pic3.zhimg.com/c04d56309b493bd2a0d3db26d0916206_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;700&#x27;%20height=&#x27;465&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;700\&quot; data-rawheight=\&quot;465\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;700\&quot; data-original=\&quot;https://pic3.zhimg.com/c04d56309b493bd2a0d3db26d0916206_r.png\&quot; data-actualsrc=\&quot;https://pic3.zhimg.com/50/c04d56309b493bd2a0d3db26d0916206_hd.png\&quot;&gt;&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic1.zhimg.com/50/f41d8d145b8a8fe30abba37ede85c778_hd.png\&quot; data-rawwidth=\&quot;695\&quot; data-rawheight=\&quot;370\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;695\&quot; data-original=\&quot;https://pic1.zhimg.com/f41d8d145b8a8fe30abba37ede85c778_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;695&#x27;%20height=&#x27;370&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;695\&quot; data-rawheight=\&quot;370\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;695\&quot; data-original=\&quot;https://pic1.zhimg.com/f41d8d145b8a8fe30abba37ede85c778_r.png\&quot; data-actualsrc=\&quot;https://pic1.zhimg.com/50/f41d8d145b8a8fe30abba37ede85c778_hd.png\&quot;&gt;&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic1.zhimg.com/50/797a561056109585428a10c9a6278874_hd.png\&quot; data-rawwidth=\&quot;700\&quot; data-rawheight=\&quot;447\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;700\&quot; data-original=\&quot;https://pic1.zhimg.com/797a561056109585428a10c9a6278874_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;700&#x27;%20height=&#x27;447&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;700\&quot; data-rawheight=\&quot;447\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;700\&quot; data-original=\&quot;https://pic1.zhimg.com/797a561056109585428a10c9a6278874_r.png\&quot; data-actualsrc=\&quot;https://pic1.zhimg.com/50/797a561056109585428a10c9a6278874_hd.png\&quot;&gt;&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic1.zhimg.com/50/d4e2ac5460d08d0cd9af15bc154574e4_hd.png\&quot; data-rawwidth=\&quot;699\&quot; data-rawheight=\&quot;469\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;699\&quot; data-original=\&quot;https://pic1.zhimg.com/d4e2ac5460d08d0cd9af15bc154574e4_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;699&#x27;%20height=&#x27;469&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;699\&quot; data-rawheight=\&quot;469\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;699\&quot; data-original=\&quot;https://pic1.zhimg.com/d4e2ac5460d08d0cd9af15bc154574e4_r.png\&quot; data-actualsrc=\&quot;https://pic1.zhimg.com/50/d4e2ac5460d08d0cd9af15bc154574e4_hd.png\&quot;&gt;&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic4.zhimg.com/50/7ea97eab41a2c2eb32d356b1afd9ca2f_hd.png\&quot; data-rawwidth=\&quot;698\&quot; data-rawheight=\&quot;409\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;698\&quot; data-original=\&quot;https://pic4.zhimg.com/7ea97eab41a2c2eb32d356b1afd9ca2f_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;698&#x27;%20height=&#x27;409&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;698\&quot; data-rawheight=\&quot;409\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;698\&quot; data-original=\&quot;https://pic4.zhimg.com/7ea97eab41a2c2eb32d356b1afd9ca2f_r.png\&quot; data-actualsrc=\&quot;https://pic4.zhimg.com/50/7ea97eab41a2c2eb32d356b1afd9ca2f_hd.png\&quot;&gt;&lt;br&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic1.zhimg.com/50/5f1f741537b28b9ec9e0d6e66b76a2cc_hd.png\&quot; data-rawwidth=\&quot;699\&quot; data-rawheight=\&quot;469\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;699\&quot; data-original=\&quot;https://pic1.zhimg.com/5f1f741537b28b9ec9e0d6e66b76a2cc_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;699&#x27;%20height=&#x27;469&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;699\&quot; data-rawheight=\&quot;469\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;699\&quot; data-original=\&quot;https://pic1.zhimg.com/5f1f741537b28b9ec9e0d6e66b76a2cc_r.png\&quot; data-actualsrc=\&quot;https://pic1.zhimg.com/50/5f1f741537b28b9ec9e0d6e66b76a2cc_hd.png\&quot;&gt;&lt;br&gt;&lt;p&gt;别看才区区七张图片，可是这让计算机运行了好长的时间，期间电脑死机两次！&lt;/p&gt;&lt;p&gt;好了广告打完了，下面是福利时间&lt;/p&gt;&lt;h2&gt;&lt;b&gt;在本地用keras搭建风格转移平台&lt;/b&gt;&lt;/h2&gt;&lt;h2&gt;&lt;b&gt;1.相关依赖库的安装&lt;/b&gt;&lt;/h2&gt;&lt;div class=\&quot;highlight\&quot;&gt;&lt;pre&gt;&lt;code class=\&quot;language-text\&quot;&gt;&lt;span&gt;&lt;/span&gt;# 命令行安装keras、h5py、tensorflow\npip3 install keras\npip3 install h5py\npip3 install tensorflow\n&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;如果tensorflowan命令行安装失败，可以在这里下载whl包&lt;a href=\&quot;https://link.zhihu.com/?target=http%3A//www.lfd.uci.edu/%7Egohlke/pythonlibs/\&quot; class=\&quot; wrap external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;&gt;Python Extension Packages for Windows&lt;i class=\&quot;icon-external\&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;a href=\&quot;https://link.zhihu.com/?target=http%3A//www.lfd.uci.edu/%7Egohlke/pythonlibs/\&quot; class=\&quot; wrap external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;&gt;（进入网址后ctrl+F输入tensorflow可以快速搜索）&lt;i class=\&quot;icon-external\&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;/p&gt;&lt;h2&gt;&lt;b&gt;2.配置运行环境&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;&lt;b&gt;下载VGG16模型 &lt;/b&gt;&lt;a href=\&quot;https://link.zhihu.com/?target=https%3A//pan.baidu.com/s/1i5wYN1z\&quot; class=\&quot; external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;&gt;&lt;span class=\&quot;invisible\&quot;&gt;https://&lt;/span&gt;&lt;span class=\&quot;visible\&quot;&gt;pan.baidu.com/s/1i5wYN1&lt;/span&gt;&lt;span class=\&quot;invisible\&quot;&gt;z&lt;/span&gt;&lt;span class=\&quot;ellipsis\&quot;&gt;&lt;/span&gt;&lt;i class=\&quot;icon-external\&quot;&gt;&lt;/i&gt;&lt;/a&gt; 放入如下目录当中&lt;/p&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic1.zhimg.com/50/v2-b06fa971e3b6ebc905097f89be3ce39c_hd.png\&quot; data-rawwidth=\&quot;654\&quot; data-rawheight=\&quot;129\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;654\&quot; data-original=\&quot;https://pic1.zhimg.com/v2-b06fa971e3b6ebc905097f89be3ce39c_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;654&#x27;%20height=&#x27;129&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;654\&quot; data-rawheight=\&quot;129\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;654\&quot; data-original=\&quot;https://pic1.zhimg.com/v2-b06fa971e3b6ebc905097f89be3ce39c_r.png\&quot; data-actualsrc=\&quot;https://pic1.zhimg.com/50/v2-b06fa971e3b6ebc905097f89be3ce39c_hd.png\&quot;&gt;&lt;h2&gt;&lt;b&gt;3.代码编写&lt;/b&gt;&lt;/h2&gt;&lt;div class=\&quot;highlight\&quot;&gt;&lt;pre&gt;&lt;code class=\&quot;language-python3\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=\&quot;kn\&quot;&gt;from&lt;/span&gt; &lt;span class=\&quot;nn\&quot;&gt;__future__&lt;/span&gt; &lt;span class=\&quot;k\&quot;&gt;import&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;print_function&lt;/span&gt;\n&lt;span class=\&quot;kn\&quot;&gt;from&lt;/span&gt; &lt;span class=\&quot;nn\&quot;&gt;keras.preprocessing.image&lt;/span&gt; &lt;span class=\&quot;k\&quot;&gt;import&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;load_img&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_to_array&lt;/span&gt;\n&lt;span class=\&quot;kn\&quot;&gt;from&lt;/span&gt; &lt;span class=\&quot;nn\&quot;&gt;scipy.misc&lt;/span&gt; &lt;span class=\&quot;k\&quot;&gt;import&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;imsave&lt;/span&gt;\n&lt;span class=\&quot;kn\&quot;&gt;import&lt;/span&gt; &lt;span class=\&quot;nn\&quot;&gt;numpy&lt;/span&gt; &lt;span class=\&quot;k\&quot;&gt;as&lt;/span&gt; &lt;span class=\&quot;nn\&quot;&gt;np&lt;/span&gt;\n&lt;span class=\&quot;kn\&quot;&gt;from&lt;/span&gt; &lt;span class=\&quot;nn\&quot;&gt;scipy.optimize&lt;/span&gt; &lt;span class=\&quot;k\&quot;&gt;import&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;fmin_l_bfgs_b&lt;/span&gt;\n&lt;span class=\&quot;kn\&quot;&gt;import&lt;/span&gt; &lt;span class=\&quot;nn\&quot;&gt;time&lt;/span&gt;\n&lt;span class=\&quot;kn\&quot;&gt;import&lt;/span&gt; &lt;span class=\&quot;nn\&quot;&gt;argparse&lt;/span&gt;\n\n&lt;span class=\&quot;kn\&quot;&gt;from&lt;/span&gt; &lt;span class=\&quot;nn\&quot;&gt;keras.applications&lt;/span&gt; &lt;span class=\&quot;k\&quot;&gt;import&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;vgg16&lt;/span&gt;\n&lt;span class=\&quot;kn\&quot;&gt;from&lt;/span&gt; &lt;span class=\&quot;nn\&quot;&gt;keras&lt;/span&gt; &lt;span class=\&quot;k\&quot;&gt;import&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;backend&lt;/span&gt; &lt;span class=\&quot;k\&quot;&gt;as&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;\n\n&lt;span class=\&quot;n\&quot;&gt;parser&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;argparse&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;ArgumentParser&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;description&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;Neural style transfer with Keras.&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;parser&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;add_argument&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;base_image_path&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;metavar&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;base&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;type&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;nb\&quot;&gt;str&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt;\n                    &lt;span class=\&quot;n\&quot;&gt;help&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;Path to the image to transform.&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;parser&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;add_argument&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;style_reference_image_path&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;metavar&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;ref&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;type&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;nb\&quot;&gt;str&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt;\n                    &lt;span class=\&quot;n\&quot;&gt;help&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;Path to the style reference image.&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;parser&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;add_argument&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;result_prefix&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;metavar&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;res_prefix&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;type&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;nb\&quot;&gt;str&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt;\n                    &lt;span class=\&quot;n\&quot;&gt;help&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;Prefix for the saved results.&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;parser&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;add_argument&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;--iter&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;type&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;nb\&quot;&gt;int&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;default&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;10&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;required&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;kc\&quot;&gt;False&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt;\n                    &lt;span class=\&quot;n\&quot;&gt;help&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;Number of iterations to run.&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;parser&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;add_argument&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;--content_weight&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;type&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;nb\&quot;&gt;float&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;default&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;mf\&quot;&gt;0.025&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;required&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;kc\&quot;&gt;False&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt;\n                    &lt;span class=\&quot;n\&quot;&gt;help&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;Content weight.&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;parser&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;add_argument&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;--style_weight&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;type&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;nb\&quot;&gt;float&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;default&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;mf\&quot;&gt;1.0&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;required&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;kc\&quot;&gt;False&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt;\n                    &lt;span class=\&quot;n\&quot;&gt;help&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;Style weight.&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;parser&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;add_argument&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;--tv_weight&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;type&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;nb\&quot;&gt;float&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;default&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;mf\&quot;&gt;1.0&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;required&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;kc\&quot;&gt;False&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt;\n                    &lt;span class=\&quot;n\&quot;&gt;help&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;Total Variation weight.&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=\&quot;n\&quot;&gt;args&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;parser&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;parse_args&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;()&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;base_image_path&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;args&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;base_image_path&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;style_reference_image_path&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;args&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;style_reference_image_path&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;result_prefix&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;args&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;result_prefix&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;iterations&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;args&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;iter&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# these are the weights of the different loss components&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;total_variation_weight&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;args&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;tv_weight&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;style_weight&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;args&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;style_weight&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;content_weight&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;args&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;content_weight&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# dimensions of the generated picture.&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;width&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;height&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;load_img&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;base_image_path&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;size&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;400&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;int&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;width&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;*&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;/&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;height&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# util function to open, resize and format pictures into appropriate tensors&lt;/span&gt;\n\n\n&lt;span class=\&quot;k\&quot;&gt;def&lt;/span&gt; &lt;span class=\&quot;nf\&quot;&gt;preprocess_image&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;image_path&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;):&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;img&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;load_img&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;image_path&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;target_size&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;img&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_to_array&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;img&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;np&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;expand_dims&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;axis&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;0&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;img&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;vgg16&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;preprocess_input&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;return&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# util function to convert a tensor into a valid image&lt;/span&gt;\n\n\n&lt;span class=\&quot;k\&quot;&gt;def&lt;/span&gt; &lt;span class=\&quot;nf\&quot;&gt;deprocess_image&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;):&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;if&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;image_data_format&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;()&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;==&lt;/span&gt; &lt;span class=\&quot;s1\&quot;&gt;&#x27;channels_first&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;reshape&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;((&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;3&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;transpose&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;((&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;2&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;0&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;else&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;reshape&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;((&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;3&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n    &lt;span class=\&quot;c1\&quot;&gt;# Remove zero-center by mean pixel&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;0&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;]&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;+=&lt;/span&gt; &lt;span class=\&quot;mf\&quot;&gt;103.939&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;]&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;+=&lt;/span&gt; &lt;span class=\&quot;mf\&quot;&gt;116.779&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;2&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;]&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;+=&lt;/span&gt; &lt;span class=\&quot;mf\&quot;&gt;123.68&lt;/span&gt;\n    &lt;span class=\&quot;c1\&quot;&gt;# &#x27;BGR&#x27;-&amp;gt;&#x27;RGB&#x27;&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;::&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;]&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;np&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;clip&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;0&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;255&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;astype&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;uint8&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;return&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# get tensor representations of our images&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;base_image&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;variable&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;preprocess_image&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;base_image_path&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;style_reference_image&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;variable&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;preprocess_image&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;style_reference_image_path&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# this will contain our generated image&lt;/span&gt;\n&lt;span class=\&quot;k\&quot;&gt;if&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;image_data_format&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;()&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;==&lt;/span&gt; &lt;span class=\&quot;s1\&quot;&gt;&#x27;channels_first&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;combination_image&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;placeholder&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;((&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;3&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n&lt;span class=\&quot;k\&quot;&gt;else&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;combination_image&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;placeholder&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;((&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;3&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# combine the 3 images into a single Keras tensor&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;input_tensor&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;concatenate&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;([&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;base_image&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt;\n                              &lt;span class=\&quot;n\&quot;&gt;style_reference_image&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt;\n                              &lt;span class=\&quot;n\&quot;&gt;combination_image&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;],&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;axis&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;0&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# build the VGG16 network with our 3 images as input&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# the model will be loaded with pre-trained ImageNet weights&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;model&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;vgg16&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;VGG16&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;input_tensor&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;input_tensor&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt;\n                    &lt;span class=\&quot;n\&quot;&gt;weights&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;imagenet&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;include_top&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;kc\&quot;&gt;False&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n&lt;span class=\&quot;nb\&quot;&gt;print&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;Model loaded.&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# get the symbolic outputs of each \&quot;key\&quot; layer (we gave them unique names).&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;outputs_dict&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;dict&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;([(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;layer&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;name&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;layer&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;output&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt; &lt;span class=\&quot;k\&quot;&gt;for&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;layer&lt;/span&gt; &lt;span class=\&quot;ow\&quot;&gt;in&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;model&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;layers&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;])&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# compute the neural style loss&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# first we need to define 4 util functions&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# the gram matrix of an image tensor (feature-wise outer product)&lt;/span&gt;\n\n\n&lt;span class=\&quot;k\&quot;&gt;def&lt;/span&gt; &lt;span class=\&quot;nf\&quot;&gt;gram_matrix&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;):&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;assert&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;ndim&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;==&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;3&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;if&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;image_data_format&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;()&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;==&lt;/span&gt; &lt;span class=\&quot;s1\&quot;&gt;&#x27;channels_first&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;features&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;batch_flatten&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;else&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;features&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;batch_flatten&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;permute_dimensions&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;2&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;0&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)))&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;gram&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;dot&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;features&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;transpose&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;features&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;return&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;gram&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# the \&quot;style loss\&quot; is designed to maintain&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# the style of the reference image in the generated image.&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# It is based on the gram matrices (which capture style) of&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# feature maps from the style reference image&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# and from the generated image&lt;/span&gt;\n\n\n&lt;span class=\&quot;k\&quot;&gt;def&lt;/span&gt; &lt;span class=\&quot;nf\&quot;&gt;style_loss&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;style&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;combination&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;):&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;assert&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;ndim&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;style&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;==&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;3&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;assert&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;ndim&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;combination&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;==&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;3&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;S&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;gram_matrix&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;style&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;C&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;gram_matrix&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;combination&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;channels&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;3&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;size&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;*&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;return&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;sum&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;square&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;S&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;C&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;/&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;mf\&quot;&gt;4.&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;*&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;channels&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;**&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;2&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;*&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;size&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;**&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;2&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# an auxiliary loss function&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# designed to maintain the \&quot;content\&quot; of the&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# base image in the generated image&lt;/span&gt;\n\n\n&lt;span class=\&quot;k\&quot;&gt;def&lt;/span&gt; &lt;span class=\&quot;nf\&quot;&gt;content_loss&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;base&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;combination&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;):&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;return&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;sum&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;square&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;combination&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;base&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# the 3rd loss function, total variation loss,&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# designed to keep the generated image locally coherent&lt;/span&gt;\n\n\n&lt;span class=\&quot;k\&quot;&gt;def&lt;/span&gt; &lt;span class=\&quot;nf\&quot;&gt;total_variation_loss&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;):&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;assert&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;ndim&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;==&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;4&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;if&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;image_data_format&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;()&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;==&lt;/span&gt; &lt;span class=\&quot;s1\&quot;&gt;&#x27;channels_first&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;a&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;square&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;]&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;])&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;b&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;square&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;]&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:])&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;else&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;a&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;square&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:]&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[:,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:])&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;b&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;square&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:]&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:])&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;return&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;sum&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;pow&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;a&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;+&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;b&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mf\&quot;&gt;1.25&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# combine these loss functions into a single scalar&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;loss&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;variable&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;mf\&quot;&gt;0.&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;layer_features&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;outputs_dict&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;block4_conv2&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;]&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;base_image_features&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;layer_features&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;0&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:]&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;combination_features&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;layer_features&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;2&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:]&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;loss&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;+=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;content_weight&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;*&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;content_loss&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;base_image_features&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt;\n                                      &lt;span class=\&quot;n\&quot;&gt;combination_features&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=\&quot;n\&quot;&gt;feature_layers&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;[&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;block1_conv1&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;s1\&quot;&gt;&#x27;block2_conv1&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt;\n                  &lt;span class=\&quot;s1\&quot;&gt;&#x27;block3_conv1&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;s1\&quot;&gt;&#x27;block4_conv1&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt;\n                  &lt;span class=\&quot;s1\&quot;&gt;&#x27;block5_conv1&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;]&lt;/span&gt;\n&lt;span class=\&quot;k\&quot;&gt;for&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;layer_name&lt;/span&gt; &lt;span class=\&quot;ow\&quot;&gt;in&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;feature_layers&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;layer_features&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;outputs_dict&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;layer_name&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;]&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;style_reference_features&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;layer_features&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:]&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;combination_features&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;layer_features&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;2&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;:]&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;sl&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;style_loss&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;style_reference_features&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;combination_features&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;loss&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;+=&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;style_weight&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;/&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;len&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;feature_layers&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;*&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;sl&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;loss&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;+=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;total_variation_weight&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;*&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;total_variation_loss&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;combination_image&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# get the gradients of the generated image wrt the loss&lt;/span&gt;\n&lt;span class=\&quot;n\&quot;&gt;grads&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;gradients&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;loss&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;combination_image&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=\&quot;n\&quot;&gt;outputs&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;[&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;loss&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;]&lt;/span&gt;\n&lt;span class=\&quot;k\&quot;&gt;if&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;isinstance&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;grads&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;nb\&quot;&gt;list&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;tuple&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)):&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;outputs&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;+=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;grads&lt;/span&gt;\n&lt;span class=\&quot;k\&quot;&gt;else&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;outputs&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;append&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;grads&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=\&quot;n\&quot;&gt;f_outputs&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;function&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;([&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;combination_image&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;],&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;outputs&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n\n\n&lt;span class=\&quot;k\&quot;&gt;def&lt;/span&gt; &lt;span class=\&quot;nf\&quot;&gt;eval_loss_and_grads&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;):&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;if&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;image_data_format&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;()&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;==&lt;/span&gt; &lt;span class=\&quot;s1\&quot;&gt;&#x27;channels_first&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;reshape&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;((&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;3&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;else&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;reshape&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;((&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;3&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;outs&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;f_outputs&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;([&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;])&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;loss_value&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;outs&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;0&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;]&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;if&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;len&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;outs&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:])&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;==&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;grad_values&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;outs&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;]&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;flatten&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;()&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;astype&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;float64&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;else&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;grad_values&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;np&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;array&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;outs&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;[&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:])&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;flatten&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;()&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;astype&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;float64&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;k\&quot;&gt;return&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;loss_value&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;grad_values&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# this Evaluator class makes it possible&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# to compute loss and gradients in one pass&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# while retrieving them via two separate functions,&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# \&quot;loss\&quot; and \&quot;grads\&quot;. This is done because scipy.optimize&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# requires separate functions for loss and gradients,&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# but computing them separately would be inefficient.&lt;/span&gt;\n\n\n&lt;span class=\&quot;k\&quot;&gt;class&lt;/span&gt; &lt;span class=\&quot;nc\&quot;&gt;Evaluator&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;nb\&quot;&gt;object&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;):&lt;/span&gt;\n\n    &lt;span class=\&quot;k\&quot;&gt;def&lt;/span&gt; &lt;span class=\&quot;nf\&quot;&gt;__init__&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;bp\&quot;&gt;self&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;):&lt;/span&gt;\n        &lt;span class=\&quot;bp\&quot;&gt;self&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;loss_value&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;kc\&quot;&gt;None&lt;/span&gt;\n        &lt;span class=\&quot;bp\&quot;&gt;self&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;grads_values&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;kc\&quot;&gt;None&lt;/span&gt;\n\n    &lt;span class=\&quot;k\&quot;&gt;def&lt;/span&gt; &lt;span class=\&quot;nf\&quot;&gt;loss&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;bp\&quot;&gt;self&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;):&lt;/span&gt;\n        &lt;span class=\&quot;k\&quot;&gt;assert&lt;/span&gt; &lt;span class=\&quot;bp\&quot;&gt;self&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;loss_value&lt;/span&gt; &lt;span class=\&quot;ow\&quot;&gt;is&lt;/span&gt; &lt;span class=\&quot;kc\&quot;&gt;None&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;loss_value&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;grad_values&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;eval_loss_and_grads&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n        &lt;span class=\&quot;bp\&quot;&gt;self&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;loss_value&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;loss_value&lt;/span&gt;\n        &lt;span class=\&quot;bp\&quot;&gt;self&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;grad_values&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;grad_values&lt;/span&gt;\n        &lt;span class=\&quot;k\&quot;&gt;return&lt;/span&gt; &lt;span class=\&quot;bp\&quot;&gt;self&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;loss_value&lt;/span&gt;\n\n    &lt;span class=\&quot;k\&quot;&gt;def&lt;/span&gt; &lt;span class=\&quot;nf\&quot;&gt;grads&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;bp\&quot;&gt;self&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;):&lt;/span&gt;\n        &lt;span class=\&quot;k\&quot;&gt;assert&lt;/span&gt; &lt;span class=\&quot;bp\&quot;&gt;self&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;loss_value&lt;/span&gt; &lt;span class=\&quot;ow\&quot;&gt;is&lt;/span&gt; &lt;span class=\&quot;ow\&quot;&gt;not&lt;/span&gt; &lt;span class=\&quot;kc\&quot;&gt;None&lt;/span&gt;\n        &lt;span class=\&quot;n\&quot;&gt;grad_values&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;np&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;copy&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;bp\&quot;&gt;self&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;grad_values&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n        &lt;span class=\&quot;bp\&quot;&gt;self&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;loss_value&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;kc\&quot;&gt;None&lt;/span&gt;\n        &lt;span class=\&quot;bp\&quot;&gt;self&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;grad_values&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;kc\&quot;&gt;None&lt;/span&gt;\n        &lt;span class=\&quot;k\&quot;&gt;return&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;grad_values&lt;/span&gt;\n\n&lt;span class=\&quot;n\&quot;&gt;evaluator&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;Evaluator&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;()&lt;/span&gt;\n\n&lt;span class=\&quot;c1\&quot;&gt;# run scipy-based optimization (L-BFGS) over the pixels of the generated image&lt;/span&gt;\n&lt;span class=\&quot;c1\&quot;&gt;# so as to minimize the neural style loss&lt;/span&gt;\n&lt;span class=\&quot;k\&quot;&gt;if&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;K&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;image_data_format&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;()&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;==&lt;/span&gt; &lt;span class=\&quot;s1\&quot;&gt;&#x27;channels_first&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;np&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;random&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;uniform&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;0&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;255&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;3&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mf\&quot;&gt;128.&lt;/span&gt;\n&lt;span class=\&quot;k\&quot;&gt;else&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;:&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;np&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;random&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;uniform&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;0&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;255&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;1&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_nrows&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img_ncols&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;mi\&quot;&gt;3&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;mf\&quot;&gt;128.&lt;/span&gt;\n\n&lt;span class=\&quot;k\&quot;&gt;for&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;i&lt;/span&gt; &lt;span class=\&quot;ow\&quot;&gt;in&lt;/span&gt; &lt;span class=\&quot;nb\&quot;&gt;range&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;iterations&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;):&lt;/span&gt;\n    &lt;span class=\&quot;nb\&quot;&gt;print&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;Start of iteration&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;i&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;start_time&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;time&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;time&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;()&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;min_val&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;info&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;fmin_l_bfgs_b&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;evaluator&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;loss&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;flatten&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(),&lt;/span&gt;\n                                     &lt;span class=\&quot;n\&quot;&gt;fprime&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;evaluator&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;grads&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;maxfun&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt;&lt;span class=\&quot;mi\&quot;&gt;20&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;nb\&quot;&gt;print&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;Current loss value:&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;min_val&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;c1\&quot;&gt;# save current generated image&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;img&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;deprocess_image&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;x&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;copy&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;())&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;fname&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;result_prefix&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;+&lt;/span&gt; &lt;span class=\&quot;s1\&quot;&gt;&#x27;_at_iteration_&lt;/span&gt;&lt;span class=\&quot;si\&quot;&gt;%d&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;.png&#x27;&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;%&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;i&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;imsave&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;fname&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;img&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n    &lt;span class=\&quot;n\&quot;&gt;end_time&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;=&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;time&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;time&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;()&lt;/span&gt;\n    &lt;span class=\&quot;nb\&quot;&gt;print&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;Image saved as&#x27;&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;fname&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;)&lt;/span&gt;\n&lt;span class=\&quot;nb\&quot;&gt;print&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;&#x27;Iteration &lt;/span&gt;&lt;span class=\&quot;si\&quot;&gt;%d&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt; completed in &lt;/span&gt;&lt;span class=\&quot;si\&quot;&gt;%d&lt;/span&gt;&lt;span class=\&quot;s1\&quot;&gt;s&#x27;&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;%&lt;/span&gt; &lt;span class=\&quot;p\&quot;&gt;(&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;i&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;,&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;end_time&lt;/span&gt; &lt;span class=\&quot;o\&quot;&gt;-&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;start_time&lt;/span&gt;&lt;span class=\&quot;p\&quot;&gt;))&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;复制上述代码保存为neural_style_transfer.py(随便命名)&lt;/p&gt;&lt;h2&gt;&lt;b&gt;4.运行&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;新建一个空文件夹，把上一步骤的文件neural_style_transfer.py放入这个空文件夹中。然后把相应的模板图片，待转化图片放入该文件当中。&lt;/p&gt;&lt;div class=\&quot;highlight\&quot;&gt;&lt;pre&gt;&lt;code class=\&quot;language-python3\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;python&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;neural_style_transfer&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;py&lt;/span&gt;   &lt;span class=\&quot;n\&quot;&gt;你的待转化图片路径&lt;/span&gt;    &lt;span class=\&quot;n\&quot;&gt;模板图片路径&lt;/span&gt;   &lt;span class=\&quot;n\&quot;&gt;保存的生产图片路径加名称&lt;/span&gt;&lt;span class=\&quot;err\&quot;&gt;（&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;注意不需要有&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;jpg等后缀&lt;/span&gt;&lt;span class=\&quot;err\&quot;&gt;）&lt;/span&gt;\n &lt;span class=\&quot;n\&quot;&gt;python&lt;/span&gt; &lt;span class=\&quot;n\&quot;&gt;neural_style_transfer&lt;/span&gt;&lt;span class=\&quot;o\&quot;&gt;.&lt;/span&gt;&lt;span class=\&quot;n\&quot;&gt;py&lt;/span&gt; &lt;span class=\&quot;s1\&quot;&gt;&#x27;./me.jpg&#x27;&lt;/span&gt; &lt;span class=\&quot;s1\&quot;&gt;&#x27;./starry_night.jpg&#x27;&lt;/span&gt; &lt;span class=\&quot;s1\&quot;&gt;&#x27;./me_t&#x27;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;迭代结果截图：&lt;/p&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic3.zhimg.com/50/v2-7bd28bae3b546a72d56e0e3d568152b2_hd.png\&quot; data-rawwidth=\&quot;484\&quot; data-rawheight=\&quot;595\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;484\&quot; data-original=\&quot;https://pic3.zhimg.com/v2-7bd28bae3b546a72d56e0e3d568152b2_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;484&#x27;%20height=&#x27;595&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;484\&quot; data-rawheight=\&quot;595\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;484\&quot; data-original=\&quot;https://pic3.zhimg.com/v2-7bd28bae3b546a72d56e0e3d568152b2_r.png\&quot; data-actualsrc=\&quot;https://pic3.zhimg.com/50/v2-7bd28bae3b546a72d56e0e3d568152b2_hd.png\&quot;&gt;&lt;h2&gt;&lt;b&gt;迭代过程对比&lt;/b&gt;&lt;/h2&gt;&lt;noscript&gt;&lt;img src=\&quot;https://pic3.zhimg.com/50/v2-325064dfc72b82872a4a70a4f87ef1e6_hd.png\&quot; data-rawwidth=\&quot;778\&quot; data-rawheight=\&quot;496\&quot; class=\&quot;origin_image zh-lightbox-thumb\&quot; width=\&quot;778\&quot; data-original=\&quot;https://pic3.zhimg.com/v2-325064dfc72b82872a4a70a4f87ef1e6_r.png\&quot;&gt;&lt;/noscript&gt;&lt;img src=\&quot;data:image/svg+xml;utf8,&amp;lt;svg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;778&#x27;%20height=&#x27;496&#x27;&amp;gt;&amp;lt;/svg&amp;gt;\&quot; data-rawwidth=\&quot;778\&quot; data-rawheight=\&quot;496\&quot; class=\&quot;origin_image zh-lightbox-thumb lazy\&quot; width=\&quot;778\&quot; data-original=\&quot;https://pic3.zhimg.com/v2-325064dfc72b82872a4a70a4f87ef1e6_r.png\&quot; data-actualsrc=\&quot;https://pic3.zhimg.com/50/v2-325064dfc72b82872a4a70a4f87ef1e6_hd.png\&quot;&gt;&lt;br&gt;&lt;h2&gt;&lt;b&gt;其它库实现风格转化&lt;/b&gt;&lt;/h2&gt;&lt;p&gt;基于python深度学习库DeepPy的实现：&lt;a href=\&quot;https://link.zhihu.com/?target=https%3A//github.com/andersbll/neural_artistic_style\&quot; class=\&quot; wrap external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;&gt;GitHub - andersbll/neural_artistic_style: Neural Artistic Style in Python&lt;i class=\&quot;icon-external\&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;基于python深度学习库TensorFlow的实现：&lt;a href=\&quot;https://link.zhihu.com/?target=https%3A//github.com/anishathalye/neural-style\&quot; class=\&quot; wrap external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;&gt;GitHub - anishathalye/neural-style: Neural style in TensorFlow!&lt;i class=\&quot;icon-external\&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;基于python深度学习库Caffe的实现：&lt;a href=\&quot;https://link.zhihu.com/?target=https%3A//github.com/fzliu/style-transfer\&quot; class=\&quot; external\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer\&quot;&gt;&lt;span class=\&quot;invisible\&quot;&gt;https://&lt;/span&gt;&lt;span class=\&quot;visible\&quot;&gt;github.com/fzliu/style-&lt;/span&gt;&lt;span class=\&quot;invisible\&quot;&gt;transfer&lt;/span&gt;&lt;span class=\&quot;ellipsis\&quot;&gt;&lt;/span&gt;&lt;i class=\&quot;icon-external\&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;/p&gt;&quot;,&quot;commentCount&quot;:418,&quot;extras&quot;:&quot;&quot;,&quot;reshipmentSettings&quot;:&quot;allowed&quot;,&quot;rewardInfo&quot;:{&quot;rewardMemberCount&quot;:0,&quot;tagline&quot;:&quot;&quot;,&quot;rewardTotalMoney&quot;:0,&quot;canOpenReward&quot;:false,&quot;isRewardable&quot;:false},&quot;isCopyable&quot;:true,&quot;type&quot;:&quot;answer&quot;,&quot;thumbnail&quot;:&quot;https://pic3.zhimg.com/98cab4f35d2084f969a8189e90b47dee_200x112.jpg&quot;,&quot;isNormal&quot;:true}},&quot;articles&quot;:{},&quot;columns&quot;:{},&quot;topics&quot;:{},&quot;roundtables&quot;:{},&quot;favlists&quot;:{},&quot;comments&quot;:{},&quot;notifications&quot;:{},&quot;ebooks&quot;:{},&quot;activities&quot;:{},&quot;feeds&quot;:{},&quot;pins&quot;:{},&quot;promotions&quot;:{}},&quot;currentUser&quot;:&quot;&quot;,&quot;token&quot;:{&quot;xsrf&quot;:&quot;ebc7e412-f965-4966-9482-2a7b39d96950&quot;,&quot;xUDID&quot;:&quot;&quot;},&quot;account&quot;:{&quot;locakTicketStatus&quot;:false,&quot;challenge&quot;:[],&quot;errorStatus&quot;:false,&quot;message&quot;:&quot;&quot;,&quot;isFetching&quot;:false},&quot;notification&quot;:{},&quot;people&quot;:{&quot;isFetching&quot;:false,&quot;activitiesByUser&quot;:{},&quot;answersByUser&quot;:{},&quot;answersSortByVotesByUser&quot;:{},&quot;answersMarkedByUser&quot;:{},&quot;votedAnswersByUser&quot;:{},&quot;thankedAnswersByUser&quot;:{},&quot;voteAnswersByUser&quot;:{},&quot;thankAnswersByUser&quot;:{},&quot;topicAnswersByUser&quot;:{},&quot;articlesByUser&quot;:{},&quot;articlesSortByVotesByUser&quot;:{},&quot;pinsByUser&quot;:{},&quot;questionsByUser&quot;:{},&quot;commercialQuestionsByUser&quot;:{},&quot;favlistsByUser&quot;:{},&quot;followingByUser&quot;:{},&quot;followersByUser&quot;:{},&quot;mutualsByUser&quot;:{},&quot;followingColumnsByUser&quot;:{},&quot;followingQuestionsByUser&quot;:{},&quot;followingFavlistsByUser&quot;:{},&quot;followingTopicsByUser&quot;:{},&quot;publicationsByUser&quot;:{},&quot;columnsByUser&quot;:{},&quot;allFavlistsByUser&quot;:{},&quot;brands&quot;:null},&quot;env&quot;:{&quot;experiment&quot;:{&quot;ge3&quot;:&quot;ge3_9&quot;,&quot;ge2&quot;:&quot;ge2_1&quot;,&quot;isOffice&quot;:&quot;false&quot;,&quot;nwebStickySidebar&quot;:&quot;sticky&quot;,&quot;qrcodeLogin&quot;:&quot;qrcode&quot;,&quot;favAct&quot;:&quot;default&quot;,&quot;default&quot;:&quot;None&quot;,&quot;mobileQaPageProxyHeifetz&quot;:&quot;m_qa_page_nweb&quot;,&quot;newMore&quot;:&quot;new&quot;,&quot;newBuyBar&quot;:&quot;livenewbuy3&quot;,&quot;newMobileColumnAppheader&quot;:&quot;new_header&quot;,&quot;appStoreRateDialog&quot;:&quot;close&quot;,&quot;sendZaMonitor&quot;:&quot;true&quot;,&quot;homeUi2&quot;:&quot;default&quot;,&quot;answerRelatedReadings&quot;:&quot;qa_recommend_with_ads_and_article&quot;,&quot;wechatShareModal&quot;:&quot;wechat_share_modal_show&quot;,&quot;iOSNewestVersion&quot;:&quot;4.2.0&quot;,&quot;qaStickySidebar&quot;:&quot;sticky_sidebar&quot;,&quot;androidProfilePanel&quot;:&quot;panel_b&quot;,&quot;liveStore&quot;:&quot;ls_a2_b2_c1_f2&quot;,&quot;zcmLighting&quot;:&quot;zcm&quot;},&quot;userAgent&quot;:{&quot;Edge&quot;:false,&quot;Wechat&quot;:false,&quot;Weibo&quot;:false,&quot;QQ&quot;:false,&quot;Mobile&quot;:false,&quot;Android&quot;:false,&quot;iOS&quot;:false,&quot;isAppleDevice&quot;:false,&quot;Zhihu&quot;:false,&quot;isBot&quot;:false,&quot;isWebView&quot;:false},&quot;trafficSource&quot;:&quot;&quot;,&quot;edition&quot;:{&quot;baidu&quot;:false,&quot;yidianzixun&quot;:false},&quot;theme&quot;:&quot;light&quot;,&quot;referer&quot;:&quot;&quot;,&quot;conf&quot;:{&quot;unblockContacts&quot;:{&quot;telecom&quot;:&quot;1069 0920 21212&quot;,&quot;mobile&quot;:&quot;1069 02098 21212&quot;,&quot;unicom&quot;:&quot;1069 0920 21212&quot;}}},&quot;config&quot;:{&quot;isWindow&quot;:1,&quot;canWrite&quot;:false,&quot;alertTimeSpan&quot;:3600,&quot;tip&quot;:&quot;应国家法规对于帐号实名的要求，进行下一步操作前，需要先完成手机绑定。&quot;},&quot;pushNotifications&quot;:{&quot;default&quot;:{&quot;isFetching&quot;:false,&quot;isDrained&quot;:false,&quot;ids&quot;:[]},&quot;follow&quot;:{&quot;isFetching&quot;:false,&quot;isDrained&quot;:false,&quot;ids&quot;:[]},&quot;vote-thank&quot;:{&quot;isFetching&quot;:false,&quot;isDrained&quot;:false,&quot;ids&quot;:[]},&quot;currentTab&quot;:&quot;default&quot;,&quot;notificationsCount&quot;:{&quot;default&quot;:0,&quot;follow&quot;:0,&quot;vote-thank&quot;:0}},&quot;messages&quot;:{&quot;data&quot;:{},&quot;currentTab&quot;:&quot;common&quot;,&quot;messageCount&quot;:0},&quot;register&quot;:{&quot;registerValidateSucceeded&quot;:null,&quot;registerValidateErrors&quot;:{},&quot;registerConfirmError&quot;:null,&quot;sendDigitsError&quot;:null,&quot;registerConfirmSucceeded&quot;:null},&quot;login&quot;:{&quot;loginConfirmError&quot;:null,&quot;sendDigitsError&quot;:null,&quot;loginConfirmSucceeded&quot;:null,&quot;qrcodeLoginToken&quot;:&quot;&quot;,&quot;qrcodeLoginScanStatus&quot;:0,&quot;qrcodeLoginError&quot;:null,&quot;qrcodeLoginReturnNewToken&quot;:false},&quot;active&quot;:{&quot;sendDigitsError&quot;:null,&quot;activeConfirmSucceeded&quot;:null,&quot;activeConfirmError&quot;:null},&quot;question&quot;:{&quot;followers&quot;:{},&quot;concernedFollowers&quot;:{},&quot;answers&quot;:{&quot;21395276&quot;:{&quot;isFetching&quot;:false,&quot;isDrained&quot;:false,&quot;ids&quot;:[115805610,74966923,18137210],&quot;newIds&quot;:[115805610,74966923,18137210],&quot;totals&quot;:170,&quot;isPrevDrained&quot;:true,&quot;previous&quot;:&quot;http://www.zhihu.com/api/v4/questions/21395276/answers?sort_by=default&amp;include=data%5B%2A%5D.is_normal%2Cadmin_closed_comment%2Creward_info%2Cis_collapsed%2Cannotation_action%2Cannotation_detail%2Ccollapse_reason%2Cis_sticky%2Ccollapsed_by%2Csuggest_edit%2Ccomment_count%2Ccan_comment%2Ccontent%2Ceditable_content%2Cvoteup_count%2Creshipment_settings%2Ccomment_permission%2Ccreated_time%2Cupdated_time%2Creview_info%2Cquestion%2Cexcerpt%2Crelationship.is_authorized%2Cis_author%2Cvoting%2Cis_thanked%2Cis_nothelp%2Cupvoted_followees%3Bdata%5B%2A%5D.mark_infos%5B%2A%5D.url%3Bdata%5B%2A%5D.author.follower_count%2Cbadge%5B%3F%28type%3Dbest_answerer%29%5D.topics&amp;limit=3&amp;offset=0&quot;,&quot;next&quot;:&quot;http://www.zhihu.com/api/v4/questions/21395276/answers?sort_by=default&amp;include=data%5B%2A%5D.is_normal%2Cadmin_closed_comment%2Creward_info%2Cis_collapsed%2Cannotation_action%2Cannotation_detail%2Ccollapse_reason%2Cis_sticky%2Ccollapsed_by%2Csuggest_edit%2Ccomment_count%2Ccan_comment%2Ccontent%2Ceditable_content%2Cvoteup_count%2Creshipment_settings%2Ccomment_permission%2Ccreated_time%2Cupdated_time%2Creview_info%2Cquestion%2Cexcerpt%2Crelationship.is_authorized%2Cis_author%2Cvoting%2Cis_thanked%2Cis_nothelp%2Cupvoted_followees%3Bdata%5B%2A%5D.mark_infos%5B%2A%5D.url%3Bdata%5B%2A%5D.author.follower_count%2Cbadge%5B%3F%28type%3Dbest_answerer%29%5D.topics&amp;limit=3&amp;offset=3&quot;}},&quot;hiddenAnswers&quot;:{},&quot;createdAnswers&quot;:{},&quot;collapsedAnswers&quot;:{},&quot;notificationAnswers&quot;:{},&quot;invitationCandidates&quot;:{},&quot;inviters&quot;:{},&quot;invitees&quot;:{},&quot;similarQuestions&quot;:{},&quot;relatedLives&quot;:{},&quot;recommendReadings&quot;:{},&quot;bio&quot;:{},&quot;brand&quot;:{},&quot;commonAnswerCount&quot;:0,&quot;hiddenAnswerCount&quot;:0},&quot;comments&quot;:{&quot;pagination&quot;:{},&quot;collapsed&quot;:{},&quot;reverse&quot;:{},&quot;reviewing&quot;:{},&quot;conversation&quot;:{},&quot;parent&quot;:{}},&quot;shareTexts&quot;:{},&quot;answers&quot;:{&quot;voters&quot;:{},&quot;copyrightApplicants&quot;:{},&quot;favlists&quot;:{},&quot;newAnswer&quot;:{}},&quot;banner&quot;:{},&quot;topics&quot;:{&quot;bios&quot;:{}},&quot;captcha&quot;:{&quot;captchaNeeded&quot;:false,&quot;captchaBase64String&quot;:null,&quot;captchaValidationMessage&quot;:null,&quot;loginCaptchaExpires&quot;:false},&quot;sms&quot;:{&quot;supportedCountries&quot;:[]},&quot;explore&quot;:{&quot;recommendations&quot;:{},&quot;hotfeeds&quot;:{}},&quot;articles&quot;:{&quot;voters&quot;:{}},&quot;favlists&quot;:{&quot;relations&quot;:{}},&quot;pins&quot;:{&quot;voters&quot;:{}},&quot;topstory&quot;:{&quot;topstorys&quot;:{&quot;isFetching&quot;:false,&quot;isDrained&quot;:false,&quot;afterId&quot;:0,&quot;items&quot;:[],&quot;next&quot;:null},&quot;sidebar&quot;:null,&quot;announcement&quot;:{}},&quot;upload&quot;:{},&quot;video&quot;:{&quot;data&quot;:{}},&quot;guide&quot;:{&quot;guide&quot;:{&quot;isFetching&quot;:false,&quot;isShowGuide&quot;:false}},&quot;switches&quot;:{},&quot;coupon&quot;:{&quot;isRedeemingCoupon&quot;:false},&quot;reward&quot;:{},&quot;search&quot;:{&quot;recommendSearch&quot;:[],&quot;topSearch&quot;:{},&quot;generalByQuery&quot;:{},&quot;peopleByQuery&quot;:{},&quot;topicByQuery&quot;:{},&quot;columnByQuery&quot;:{},&quot;liveByQuery&quot;:{},&quot;eBookByQuery&quot;:{}},&quot;org&quot;:{&quot;resume&quot;:{}}}" data-config="{&quot;apiAddress&quot;:&quot;/api/v4/&quot;,&quot;deployEnv&quot;:&quot;production&quot;}" data-reactid="20"></div><script src="https://static.zhihu.com/heifetz/vendor.1f389462803af519e7ae.js" data-reactid="21"></script><script src="https://static.zhihu.com/heifetz/main.raven.d98f1be0fbf6aa8aa3db.js" async="" data-reactid="22"></script><script src="https://static.zhihu.com/heifetz/main.app.f6071383be14c8cf75dc.js" data-reactid="23"></script><script data-reactid="24"></script></body></html>